import{r as M,w as A,k as T,n as O,U as F,ad as X,d as Y,e as B,c as U,a as q,ay as N,o as V,u as Z}from"./@vue-DtXbQ2UY.js";import{p as o}from"./paper-CDkzWgxa.js";import{D as J}from"./demo1-CqUKacF1.js";import{_ as K}from"./plugin-vueexport-helper-DlAUqK2U.js";import"./@turf-n0MF4LHv.js";import"./acorn-5sB4GZPC.js";const Q=p=>{p={...{zoom:!0,canvasHandle:"drag",itemHandle:"none",tooltips:""},...p};const u=M(new o.PaperScope),C=M(),k=M(1),y=M(),f=M(),v=M("default"),z={x:0,y:0},P=new WeakMap;A(()=>f.value,(t,n)=>{n&&n[0].remove()});const W=t=>{p.zoom&&(t.preventDefault(),u.value.view.zoom=u.value.view.zoom*(1+t.wheelDelta/1e3),k.value=u.value.view.zoom)},S=()=>{u.value.view.onMouseDown=t=>{var b,a;const n=t.target,i=X(u.value.view);if(p.canvasHandle==="drag"){const c=h=>{const w=h.x-z.x,x=h.y-z.y;u.value.view.translate({x:w/k.value,y:x/k.value}),z.x=h.x,z.y=h.y},d=()=>{var h,w;(h=C.value)==null||h.removeEventListener("mousemove",c),(w=C.value)==null||w.removeEventListener("mouseup",d)};n===i&&(z.x=t.event.pageX,z.y=t.event.pageY,k.value=u.value.view.zoom,(b=C.value)==null||b.addEventListener("mousemove",c),(a=C.value)==null||a.addEventListener("mouseup",d))}if(p.canvasHandle==="select"&&(n===i&&(y.value=new o.Path.Rectangle(t.point,new o.Size(1,1)),y.value.strokeWidth=1,y.value.strokeColor=new o.Color(0,0,0,.5),y.value.style.dashArray=[4,4],y.value.name="selection"),f.value&&n===i)){const c=f.value[2].removeChildren();c==null||c.forEach(d=>{d.addTo(u.value.project)}),f.value=void 0}},u.value.view.onMouseDrag=t=>{y.value&&(y.value.bounds.width+=t.delta.x,y.value.bounds.height+=t.delta.y)},u.value.view.onMouseUp=t=>{var n;if(y.value){let i=[];const b=u.value.project.getItems({match:a=>{if(!a.parent)return;let c,d;if(u.value.project.activeLayer===a.parent?(c=a.bounds.topLeft,d=a.bounds.bottomRight):(c=a.parent.bounds.topLeft,d=a.parent.bounds.bottomRight),c.x>y.value.bounds.topLeft.x&&c.y>y.value.bounds.topLeft.y&&d.x<y.value.bounds.bottomRight.x&&d.y<y.value.bounds.bottomRight.y){if(a instanceof o.Group)return i.push(...a.children),a;if(!i.includes(a))return a}}});if(b.length){const a=new o.Group([...b]);a.name="group",f.value=R(a),(n=u.value.project)==null||n.activeLayer.addChild(f.value[1])}y.value&&(y.value.remove(),y.value=void 0),z.x=0,z.y=0}}},R=t=>{var j;const n=new o.Path.Rectangle({center:t.bounds.center,size:t.bounds.size,strokeColor:new o.Color("blue"),strokeWidth:1}),i=new o.Path.Rectangle({center:t.bounds.topLeft,size:[10,10],fillColor:new o.Color("#fff"),strokeColor:new o.Color("blue"),strokeWidth:1,name:"topLeftRect"}),b=new o.Path.Rectangle({center:t.bounds.topRight,size:[10,10],fillColor:new o.Color("#fff"),strokeColor:new o.Color("blue"),strokeWidth:1,name:"topRightRect"}),a=new o.Path.Rectangle({center:t.bounds.bottomLeft,size:[10,10],fillColor:new o.Color("#fff"),strokeColor:new o.Color("blue"),strokeWidth:1,name:"bottomLeftRect"}),c=new o.Path.Rectangle({center:t.bounds.bottomRight,size:[10,10],fillColor:new o.Color("#fff"),strokeColor:new o.Color("blue"),strokeWidth:1,name:"bottomRightRect"}),d=new o.Path.Rectangle({center:t.bounds.topCenter,size:[10,10],fillColor:new o.Color("#fff"),strokeColor:new o.Color("blue"),strokeWidth:1,name:"topCenterRect"}),h=new o.Path.Rectangle({center:t.bounds.leftCenter,size:[10,10],fillColor:new o.Color("#fff"),strokeColor:new o.Color("blue"),strokeWidth:1,name:"leftCenterRect"}),w=new o.Path.Rectangle({center:t.bounds.rightCenter,size:[10,10],fillColor:new o.Color("#fff"),strokeColor:new o.Color("blue"),strokeWidth:1,name:"rightCenterRect"}),x=new o.Path.Rectangle({center:t.bounds.bottomCenter,size:[10,10],fillColor:new o.Color("#fff"),strokeColor:new o.Color("blue"),strokeWidth:1,name:"bottomCenterRect"}),E=new o.Group([n,i,b,a,c,d,h,w,x]),I=new o.Group([t,E]);return(j=p.itemHandle)!=null&&j.includes("drag")&&(I.onMouseDrag=e=>{e.stopPropagation(),t.position.set(t.position.x+e.delta.x,t.position.y+e.delta.y),E.position.set(E.position.x+e.delta.x,E.position.y+e.delta.y)}),i.onMouseDrag=e=>{e.stopPropagation(),!(t.bounds.size.height-e.delta.y<=20||t.bounds.size.width-e.delta.x<=20)&&(t.bounds.center.y+=e.delta.y,t.bounds.center.x+=e.delta.x,t.bounds.size.height-=e.delta.y,t.bounds.size.width-=e.delta.x,n.bounds.center.y+=e.delta.y,n.bounds.center.x+=e.delta.x,n.bounds.size.height-=e.delta.y,n.bounds.size.width-=e.delta.x,i.bounds.x+=e.delta.x,i.bounds.y+=e.delta.y,b.bounds.y+=e.delta.y,a.bounds.x+=e.delta.x,d.bounds.y+=e.delta.y,d.bounds.x+=e.delta.x/2,h.bounds.y+=e.delta.y/2,h.bounds.x+=e.delta.x,w.bounds.y+=e.delta.y/2,x.bounds.x+=e.delta.x/2)},b.onMouseDrag=e=>{e.stopPropagation(),!(t.bounds.size.height-e.delta.y<=20||t.bounds.size.width+e.delta.x<=20)&&(t.bounds.center.y+=e.delta.y,t.bounds.size.height-=e.delta.y,t.bounds.size.width+=e.delta.x,n.bounds.center.y+=e.delta.y,n.bounds.size.height-=e.delta.y,n.bounds.size.width+=e.delta.x,b.bounds.x+=e.delta.x,b.bounds.y+=e.delta.y,i.bounds.y+=e.delta.y,c.bounds.x+=e.delta.x,d.bounds.y+=e.delta.y,d.bounds.x+=e.delta.x/2,h.bounds.y+=e.delta.y/2,w.bounds.y+=e.delta.y/2,w.bounds.x+=e.delta.x,x.bounds.x+=e.delta.x/2)},a.onMouseDrag=e=>{e.stopPropagation(),!(t.bounds.size.height+e.delta.y<=20||t.bounds.size.width-e.delta.x<=20)&&(t.bounds.center.x+=e.delta.x,t.bounds.size.height+=e.delta.y,t.bounds.size.width-=e.delta.x,n.bounds.center.x+=e.delta.x,n.bounds.size.height+=e.delta.y,n.bounds.size.width-=e.delta.x,a.bounds.x+=e.delta.x,a.bounds.y+=e.delta.y,i.bounds.x+=e.delta.x,c.bounds.y+=e.delta.y,d.bounds.x+=e.delta.x/2,h.bounds.y+=e.delta.y/2,h.bounds.x+=e.delta.x,w.bounds.y+=e.delta.y/2,x.bounds.y+=e.delta.y,x.bounds.x+=e.delta.x/2)},c.onMouseDrag=e=>{e.stopPropagation(),!(t.bounds.size.height+e.delta.y<=20||t.bounds.size.width+e.delta.x<=20)&&(t.bounds.size.height+=e.delta.y,t.bounds.size.width+=e.delta.x,n.bounds.size.height+=e.delta.y,n.bounds.size.width+=e.delta.x,c.bounds.x+=e.delta.x,c.bounds.y+=e.delta.y,b.bounds.x+=e.delta.x,a.bounds.y+=e.delta.y,d.bounds.x+=e.delta.x/2,h.bounds.y+=e.delta.y/2,w.bounds.y+=e.delta.y/2,w.bounds.x+=e.delta.x,x.bounds.y+=e.delta.y,x.bounds.x+=e.delta.x/2)},d.onMouseDrag=e=>{e.stopPropagation(),!(t.bounds.size.height-e.delta.y<=20)&&(t.bounds.center.y+=e.delta.y,t.bounds.size.height-=e.delta.y,n.bounds.center.y+=e.delta.y,n.bounds.size.height-=e.delta.y,i.bounds.y+=e.delta.y,b.bounds.y+=e.delta.y,d.bounds.y+=e.delta.y,h.bounds.y+=e.delta.y/2,w.bounds.y+=e.delta.y/2)},h.onMouseDrag=e=>{e.stopPropagation(),!(t.bounds.size.width-e.delta.x<=20)&&(t.bounds.center.x+=e.delta.x,t.bounds.size.width-=e.delta.x,n.bounds.center.x+=e.delta.x,n.bounds.size.width-=e.delta.x,i.bounds.x+=e.delta.x,a.bounds.x+=e.delta.x,h.bounds.x+=e.delta.x,d.bounds.x+=e.delta.x/2,x.bounds.x+=e.delta.x/2)},x.onMouseDrag=e=>{e.stopPropagation(),!(t.bounds.size.height+e.delta.y<=20)&&(t.bounds.size.height+=e.delta.y,n.bounds.size.height+=e.delta.y,a.bounds.y+=e.delta.y,c.bounds.y+=e.delta.y,x.bounds.y+=e.delta.y,h.bounds.y+=e.delta.y/2,w.bounds.y+=e.delta.y/2)},w.onMouseDrag=e=>{e.stopPropagation(),!(t.bounds.size.width+e.delta.x<=20)&&(t.bounds.size.width+=e.delta.x,n.bounds.size.width+=e.delta.x,b.bounds.x+=e.delta.x,c.bounds.x+=e.delta.x,w.bounds.x+=e.delta.x,d.bounds.x+=e.delta.x/2,x.bounds.x+=e.delta.x/2)},[i,b,a,c,d,h,w,x].forEach(e=>{e.onMouseLeave=H=>{H.stopPropagation(),v.value="default"},e.onMouseEnter=H=>{switch(H.stopPropagation(),H.target.name){case"topLeftRect":v.value="nw-resize";break;case"topRightRect":v.value="ne-resize";break;case"bottomLeftRect":v.value="sw-resize";break;case"bottomRightRect":v.value="se-resize";break;case"topCenterRect":v.value="n-resize";break;case"leftCenterRect":v.value="w-resize";break;case"rightCenterRect":v.value="e-resize";break;case"bottomCenterRect":v.value="s-resize";break}}}),[E,I,t]},G=()=>{const t=u.value.project.activeLayer.children;t==null||t.forEach(n=>{n.onMouseDown=D,n.onMouseDrag=i=>{_(i,n)},n.onMouseEnter=L,n.onMouseLeave=s,n.onMouseMove=l})},D=t=>{var n;(n=p.itemHandle)!=null&&n.includes("select")?(P.has(t.target)?(f.value=P.get(t.target),f.value[0].remove(),P.delete(t.target),f.value=R(new o.Group(t.target))):f.value?f.value[1].getItems({match:b=>{if(b===t.target)return b}}).length||(f.value=R(new o.Group(t.target)),P.set(t.target,f.value)):f.value=R(new o.Group(t.target)),u.value.project.activeLayer.addChild(f.value[1])):(p.itemHandle==="drag"||p.itemHandle&&p.itemHandle[0]==="drag")&&u.value.project.activeLayer.addChild(t.target)},_=(t,n)=>{(p.itemHandle==="drag"||p.itemHandle&&p.itemHandle[0]==="drag")&&n.position.set(n.position.x+t.delta.x,n.position.y+t.delta.y),g(t)},L=()=>{v.value="pointer"},s=()=>{v.value="defatul";let t=document.querySelector(".tootips");t&&p.tooltips&&(t.style.display="none")},l=t=>{g(t)},r=t=>{t.onMouseDown=D,t.onMouseDrag=n=>{_(n,t)},t.onMouseEnter=L,t.onMouseLeave=s,t.onMouseMove=l},g=t=>{if(!p.tooltips)return;let n=document.querySelector(".tootips");n?(n.style.display="block",n.style.left=t.event.offsetX+10+"px",n.style.top=t.event.offsetY+10+"px"):(n=document.createElement("div"),document.body.appendChild(n),n.innerHTML=typeof p.tooltips=="string"?p.tooltips:p.tooltips(),n.className="tootips",n.style.position="absolute",n.style.left=t.event.offsetX+10+"px",n.style.top=t.event.offsetY+10+"px",n.style.color="#999")};return T(()=>{var t;u.value.setup(C.value),(t=C.value)==null||t.addEventListener("wheel",W),O(()=>{S(),G()})}),F(()=>{var t;u.value.project.clear(),(t=C.value)==null||t.removeEventListener("wheel",W)}),{paperInstance:u,canvasEl:C,zoom:k,cursor:v,selectionGroup:f,addSelect:R,registerItemMouseEvent:r}},$={class:"container"},ee={name:"Paper"},te=Y({...ee,setup(p){N(s=>({"446b7428":Z(k)}));let m="right";const u=B({zoom:!0,canvasHandle:"select",itemHandle:["select","drag"],tooltips:()=>"123"}),{canvasEl:C,cursor:k,registerItemMouseEvent:y}=Q(u),f=()=>{const s=new o.Path.Circle({center:[200,100],radius:50});s.strokeColor=new o.Color("black"),s.fillColor=new o.Color("white"),s.onFrame=()=>{const l=document.body.clientWidth;m==="right"?s.bounds.right>=l&&(m="left"):s.bounds.left<=0&&(m="right"),m==="right"?s.bounds.x+=5:s.bounds.x-=5}},v=()=>{const s=new o.Path.Circle({center:[200,100],radius:50,fillColor:new o.Color("red"),strokeColor:new o.Color("black"),cursor:"pointer"});s.strokeWidth=2;const l="M 50 100 L 100 0 L 0 0 Z",r=new o.Path(l);r.strokeColor=new o.Color("black"),r.fillColor=new o.Color("green"),r.strokeWidth=2,r.strokeWidth=2,r.position.set(400,100)},z=()=>{const s=new o.Point(500,100),l=new o.Path;l.add(s);const r=s.clone();r.set(600,100),l.add(r),l.strokeColor=new o.Color("black"),l.strokeWidth=4},P=()=>{new o.Path.Rectangle({center:[200,400],size:[50,100],radius:[5,5],fillColor:"orange",strokeColor:"black",strokeWidth:4,rotation:45});const s=new o.Point(200,20),l=new o.Size(200,200),r=new o.Rectangle(s,l),g=new o.Size(30,30),t=new o.Path.Rectangle(r,g);t.fillColor=new o.Color("blue"),t.position.set({x:300,y:300})},W=()=>{const s=new o.Raster(J),l=new o.Rectangle(s.bounds.topLeft,s.bounds.size),r=new o.Path.Rectangle(l);r.strokeColor=new o.Color("transparent"),r.strokeWidth=4,s.position.set(700,600),s.scale(.2)},S=()=>{new o.PointText({position:[1600,50],fillColor:"black",justification:"center",fontSize:20,content:"下载",locked:!1,name:"download",style:{cursor:"pointer"}})},R=()=>{const s=new o.PointText({position:[0,-60],content:"圆",fillColor:"black",justification:"center",fontSize:20}),l=new o.Path.Circle({center:[0,0],radius:50,fillColor:"red"});new o.Group([s,l]).position.set(1200,800)},G=()=>{const s=new o.Group,l=new o.Path.Circle({center:[800,200],radius:50,fillColor:new o.Color("green")});var r=L(800,200,50,Math.PI/18*19),g=L(800,200,50,Math.PI/18*1),t=new o.Point(160,60),n=new o.Point(-160,20),i=new o.Segment(r,void 0,n),b=new o.Segment(g,t,void 0);const a=new o.Path([i,b]);return a.strokeColor=new o.Color("black"),a.strokeWidth=8,a.locked=!0,a.selected=!1,a.style.strokeCap="round",s.addChildren([l,a]),s},D=()=>{const s=new o.Path.Line({from:[1200,200],to:[1200,600],strokeColor:new o.Color("red"),strokeWidth:8});s.style.dashArray=[10,10],s.onFrame=()=>{s.style.dashOffset-=1,s.style.dashOffset<=0&&(s.style.dashOffset=100)}},_=()=>{const s=new o.Group,l=new o.Path.Arc({from:[0,50],through:[50,0],to:[50,100],strokeColor:"black",fillColor:"red",strokeWidth:4}),r="M 50 50 L 50 101 L -1 50 Z",g=new o.Path(r);g.fillColor=new o.Color("white"),g.strokeWidth=0,s.addChildren([l,g])},L=(s,l,r,g)=>{var t=s+r*Math.cos(g),n=l+r*Math.sin(g);return new o.Point(t,n)};return T(()=>{v(),z(),P(),W(),S(),R(),D(),f(),_(),setTimeout(()=>{const s=G();y(s)},3e3)}),(s,l)=>(V(),U("div",$,[q("canvas",{id:"myCanvas",ref_key:"canvasEl",ref:C},null,512)]))}}),de=K(te,[["__scopeId","data-v-4e8c1a2b"]]);export{de as default};
