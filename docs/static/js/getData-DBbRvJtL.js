import{a as F,c as L,b as Q,e as H,f as K}from"./element-plus-t8j70jxJ.js";import{d as u,i as W,e as X,Z as Y,C as ee,g as te,b as oe,c as ae}from"./zoom-J9Oajw2t.js";import{Q as se,R as ne,t as le}from"./@element-plus-CLWHGgw5.js";import{d as P,e as h,I as ie,o as x,J as r,a,R as t,u as d,P as V,O as E,n as re,w as ce,r as de,c as ue}from"./@vue-AhIeOBdH.js";import{_ as R}from"./plugin-vueexport-helper-DlAUqK2U.js";import"./lodash-es-CVJ_Bk8S.js";import"./@vueuse-CAc1CHwG.js";import"./@sxzz-D_chPuIy.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-BkBTkyCe.js";import"./@turf-Bfw5sV2K.js";import"./async-validator-9PlIezaS.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@floating-ui-D0iZPv2f.js";const me={id:"cesium-container"},pe={class:"shortcut-keys"},_e={class:"btn-group"},fe={class:"btn-content"},ve={class:"btn-content"},ge={class:"btn-content"},ye={name:"Cesium"},be=P({...ye,emits:["save"],setup(S,{expose:s,emit:g}){const o=h({visible:!1,drawType:u.Point,isFull:!1});let{viewer:v,zoomFn:y,loadRoadNetwork:n,destroyed:l,init:m,adjustNorthUp:b,flyTo:D,orbitTickFunction:p,getFrame:B}=W();const{data:k,draw:M,reset:N,initDrawPoint:I,initDrawLine:G,initDrawArea:$,initEntityMove:Z}=X(v),A=g,O=()=>{var i=document.fullscreenElement;if(i)document.exitFullscreen(),o.isFull=!1;else{const e=document.getElementById("cesium-container");e.requestFullscreen&&(e.requestFullscreen(),o.isFull=!0)}},U=()=>{B()},j=i=>{var c;const e=((c=v.value)==null?void 0:c.camera.pitch)||Number((-Cesium.Math.PI/2).toFixed(15));switch(i){case"top":e<=Cesium.Math.toRadians(-10)&&p(0,.01);break;case"bottom":e>Cesium.Math.toRadians(-90)&&p(0,-.01);break;case"left":p(.01,0);break;case"right":p(-.01,0);break}},q=()=>{A("save",k.value),T()},T=()=>{N(),l(),k.value=[],o.visible=!1},z=i=>{if(!i.length)return;const e=i.map((f,J)=>({degrees:[f.lon,f.lat],index:J,data:f}));M(e,o.drawType);const c=i.map(f=>te([f.lon,f.lat])),[_,w]=oe(c),{maxDistance:C}=ae(c);D(_,w,C)};return s({open:(i,e)=>{o.drawType=i,o.visible=!0,re(()=>{m(),o.drawType===u.Point?I():o.drawType===u.Polyline?G():o.drawType===u.Polygon&&$(),Z(o.drawType),e&&v.value&&z(e)})}}),(i,e)=>{const c=L,_=F,w=Q;return x(),ie(w,{title:"地图标点",modelValue:o.visible,"onUpdate:modelValue":e[0]||(e[0]=C=>o.visible=C),center:"",fullscreen:!0,onClose:T,class:"gis-dialog","destroy-on-close":"","append-to-body":!0},{default:r(()=>[a("div",me,[e[4]||(e[4]=a("div",{id:"cesium"},null,-1)),a("div",pe,[a("div",_e,[t(_,{title:"路网地名",onClick:d(n)},{default:r(()=>[a("div",fe,[t(c,null,{default:r(()=>[t(d(se))]),_:1}),e[1]||(e[1]=a("span",null,"路网地名",-1))])]),_:1},8,["onClick"]),t(_,{title:"正向俯视",onClick:d(b)},{default:r(()=>[a("div",ve,[t(c,null,{default:r(()=>[t(d(ne))]),_:1}),e[2]||(e[2]=a("span",null,"正向俯视",-1))])]),_:1},8,["onClick"]),t(_,{title:"全屏控制",onClick:O},{default:r(()=>[a("div",ge,[t(c,null,{default:r(()=>[t(d(le))]),_:1}),a("span",null,V(o.isFull?"退出全屏":"全屏"),1)])]),_:1}),t(Y,{onZoom:d(y),class:"zoom-control"},null,8,["onZoom"])])]),t(_,{type:"primary",class:"save",onClick:q},{default:r(()=>[...e[3]||(e[3]=[E("保存",-1)])]),_:1})]),t(ee,{class:"camera-control",onMoveCamera:j,onMouseDown:U})]),_:1},8,["modelValue"])}}}),De=R(be,[["__scopeId","data-v-6bd77fb1"]]),we={class:"gis-getdata"},Ce={class:"code"},ke={class:"handle"},Te={name:"getData"},Fe=P({...Te,setup(S){const s=h({drawType:u.Point,formData:{pointData:[]},code:""});ce(()=>s.formData.pointData,(n,l)=>{const m=JSON.stringify(n);s.code=m},{deep:!0,immediate:!0});const g=de(),o=()=>{var n;(n=g.value)==null||n.open(s.drawType,s.formData.pointData)},v=n=>{n&&(s.formData.pointData=n.map(l=>({lon:l.degrees[0],lat:l.degrees[1]})))},y=()=>{s.formData.pointData=[]};return(n,l)=>{const m=K,b=H,D=F;return x(),ue("div",we,[a("div",Ce,V(s.code),1),a("div",ke,[t(b,{modelValue:s.drawType,"onUpdate:modelValue":l[0]||(l[0]=p=>s.drawType=p),onChange:y},{default:r(()=>[t(m,{label:"画点",value:d(u).Point},null,8,["value"]),t(m,{label:"画线",value:d(u).Polyline},null,8,["value"]),t(m,{label:"画面",value:d(u).Polygon},null,8,["value"])]),_:1},8,["modelValue"]),t(D,{type:"primary",onClick:o},{default:r(()=>[...l[1]||(l[1]=[E("标点",-1)])]),_:1})]),t(De,{ref_key:"gisSignRef",ref:g,onSave:v},null,512)])}}}),Ue=R(Fe,[["__scopeId","data-v-3971aae3"]]);export{Ue as default};
