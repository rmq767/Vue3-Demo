import{l as C,c as S}from"./element-plus-gomRs06A.js";import{s as L,r as M,l as B,B as D,d as P,e as Z,w as T,c as z,a as h,V as b,Q as F,K as G,aw as R,ax as V,o as O,X as x,W as k,u as y}from"./@vue-1pEateLc.js";import{l as n}from"./leaflet-dgfGk-q1.js";import"./leaflet.chinatmsproviders-MeioCgZa.js";import{p as Q,q as U}from"./@element-plus-GFHZwatb.js";import{_ as W}from"./plugin-vueexport-helper-x3n3nnut.js";import"./lodash-es-88S84ShG.js";import"./@vueuse-sS3gTgD0.js";import"./@sxzz--N-3kK7X.js";import"./@ctrl-ZggoHSuR.js";import"./dayjs-0oS7_Iqn.js";import"./@turf-VZU31W4K.js";import"./async-validator-BHjhHa7C.js";import"./memoize-one-JaOscZgY.js";import"./normalize-wheel-es-1urBKM79.js";import"./@floating-ui-_1sru3kO.js";const q=""+new URL("../png/image-BQhIfE8b.png",import.meta.url).href,A=p=>{const r=L(null),l=M([]),d=n.tileLayer.chinaProvider("GaoDe.Normal.Map",{maxZoom:18,minZoom:4}),v=n.layerGroup([d]),_=[],w=()=>{const t=n.latLng(-90,-180),o=n.latLng(90,180),s=n.latLngBounds(t,o),a=n.canvas();r.value=new n.Map(p,{maxZoom:18,minZoom:4,zoom:14,attributionControl:!1,layers:[v],maxBounds:s,renderer:a,crs:n.CRS.EPSG3857,zoomControl:!1,doubleClickZoom:!1})},g=(t,o)=>{var s;if(t!=null&&t.length){const a=[];t.forEach(e=>{a.push({lng:e.pointData[0].lon,lat:e.pointData[0].lat});const f=n.circleMarker({lat:e.pointData[0].lat,lng:e.pointData[0].lon},{stroke:!0,color:"#fff",fillColor:"red",fill:!0,fillOpacity:1,radius:10,data:{name:e.name,id:e.businessId,checked:o==null?void 0:o.includes(e.businessId)}}).addTo(r.value);_.push(f),u(f,e.name,o==null?void 0:o.includes(e.businessId)),f.on("click",i)});const c=n.latLngBounds(a);(s=r.value)==null||s.fitBounds(c,{padding:[10,10]})}},i=t=>{const o=t.target,s=o.options.data,a=!s.checked;if(a&&l.value.length+1>3){C.warning("最多只能选择3口井");return}if(!a&&l.value.length-1===0){C.warning("最少选择1口井");return}o.setStyle({data:{...s,checked:a}}),a?u(o,s.name,!0):u(o,s.name,!1)},u=(t,o,s=!1)=>{const a={permanent:!0,direction:"top",className:"",offset:[0,-5],opacity:.8};if(s)a.className="tooltip",t.bindTooltip(o,a),l.value.push(t.options.data.id);else{t.bindTooltip(o,a);const c=l.value.indexOf(t.options.data.id);c>-1&&l.value.splice(c,1)}},m=()=>{r.value&&(_.forEach(t=>{t.off("click",i)}),r.value.remove())};return B(()=>{w()}),D(()=>{m()}),{map:r,checked:l,drawPoint:g}},N=p=>(R("data-v-1996750e"),p=p(),V(),p),I=N(()=>h("div",{class:"map"},[h("div",{id:"map",class:"h-full w-full"})],-1)),K=N(()=>h("div",{class:"action"},[h("span",null,"北"),h("img",{src:q,alt:""})],-1)),X={class:"trigger"},$={name:""},j=P({...$,props:{data:{type:Array,default:()=>[]}},emits:["checked"],setup(p,{emit:r}){const l=p,d=Z({isCollpased:!1}),{checked:v,drawPoint:_}=A("map"),w=r;return T(()=>v.value,g=>{const i=[];g.forEach(u=>{let m=0,t=0;const o=l.data.find(s=>s.businessId===u);if(o){const s=o.info.map((a,c)=>{if(c===0)return{...a,width:0,height:0};{const e=a.tvd-o.info[c-1].tvd,f=a.md-o.info[c-1].md;m+=f;const E=Number((f*f-e*e).toFixed(2));return t+=E,{...a,width:t,height:m}}});i.push({...o,info:s,length:Number(t.toFixed(2)),distance:Number(m.toFixed(2))})}}),w("checked",i)},{deep:!0}),B(()=>{_(l.data,["1676779130877161474"])}),(g,i)=>{const u=S;return O(),z("div",{class:G(["leaflet-container",{collpased:d.isCollpased}])},[I,K,h("div",X,[b(u,{class:"trigger-icon",onClick:i[0]||(i[0]=m=>d.isCollpased=!d.isCollpased)},{default:F(()=>[x(b(y(Q),null,null,512),[[k,!d.isCollpased]]),x(b(y(U),null,null,512),[[k,d.isCollpased]])]),_:1})])],2)}}}),mo=W(j,[["__scopeId","data-v-1996750e"]]);export{mo as default};
