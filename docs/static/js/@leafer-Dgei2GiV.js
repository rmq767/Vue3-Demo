const J={toURL(e,t){let s=encodeURIComponent(e);return t==="text"?s="data:text/plain;charset=utf-8,"+s:t==="svg"&&(s="data:image/svg+xml,"+s),s},image:{hitCanvasSize:100,maxCacheSize:4096e3,maxPatternSize:8847360,crossOrigin:"anonymous",getRealURL(e){const{prefix:t,suffix:s}=J.image;return!s||e.startsWith("data:")||e.startsWith("blob:")||(e+=(e.includes("?")?"&":"?")+s),t&&e[0]==="/"&&(e=t+e),e}}},dt={RUNTIME:"runtime",LEAF:"leaf",TASK:"task",CNAVAS:"canvas",IMAGE:"image",types:{},create(e){const{types:t}=li;return t[e]?t[e]++:(t[e]=1,0)}},li=dt;var Ss;(function(e){e[e.No=0]="No",e[e.Yes=1]="Yes",e[e.NoAndSkip=2]="NoAndSkip",e[e.YesAndSkip=3]="YesAndSkip"})(Ss||(Ss={}));const Va={};function w(e){return e===void 0}function K(e){return e==null}function wt(e){return typeof e=="string"}const{isFinite:ui}=Number;function Ft(e){return typeof e=="number"}const{isArray:Q}=Array;function j(e){return e&&typeof e=="object"}function di(e){return JSON.stringify(e)==="{}"}const te={default:(e,t)=>(ee(t,e),ee(e,t),e),assign(e,t,s){let r;Object.keys(t).forEach(i=>{var n,o;if(r=t[i],(r==null?void 0:r.constructor)===Object&&((n=e[i])===null||n===void 0?void 0:n.constructor)===Object)return ee(e[i],t[i],s&&s[i]);s&&i in s?((o=s[i])===null||o===void 0?void 0:o.constructor)===Object&&ee(e[i]={},t[i],s[i]):e[i]=t[i]})},copyAttrs:(e,t,s)=>(s.forEach(r=>{w(t[r])||(e[r]=t[r])}),e),clone:e=>JSON.parse(JSON.stringify(e)),toMap(e){const t={};for(let s=0,r=e.length;s<r;s++)t[e[s]]=!0;return t},stintSet(e,t,s){s||(s=void 0),e[t]!==s&&(e[t]=s)}},{assign:ee}=te;class ci{get __useNaturalRatio(){return!0}get __isLinePath(){const{path:t}=this;return t&&t.length===6&&t[0]===1}get __usePathBox(){return this.__pathInputed}get __blendMode(){if(this.eraser&&this.eraser!=="path")return"destination-out";const{blendMode:t}=this;return t==="pass-through"?null:t}constructor(t){this.__leaf=t}__get(t){if(this.__input){const s=this.__input[t];if(!w(s))return s}return this[t]}__getData(){const t={tag:this.__leaf.tag},{__input:s}=this;let r;for(let i in this)i[0]!=="_"&&(r=s?s[i]:void 0,t[i]=w(r)?this[i]:r);return t}__setInput(t,s){this.__input||(this.__input={}),this.__input[t]=s}__getInput(t){if(this.__input){const s=this.__input[t];if(!w(s))return s}if(t!=="path"||this.__pathInputed)return this["_"+t]}__removeInput(t){this.__input&&!w(this.__input[t])&&(this.__input[t]=void 0)}__getInputData(t,s){const r={};if(t)if(Q(t))for(let i of t)r[i]=this.__getInput(i);else for(let i in t)r[i]=this.__getInput(i);else{let i,n,{__input:o}=this;r.tag=this.__leaf.tag;for(let a in this)if(a[0]!=="_"&&(i=this["_"+a],!w(i))){if(a==="path"&&!this.__pathInputed)continue;n=o?o[a]:void 0,r[a]=w(n)?i:n}}if(s&&s.matrix){const{a:i,b:n,c:o,d:a,e:l,f:u}=this.__leaf.__localMatrix;r.matrix={a:i,b:n,c:o,d:a,e:l,f:u}}return r}__setMiddle(t,s){this.__middle||(this.__middle={}),this.__middle[t]=s}__getMiddle(t){return this.__middle&&this.__middle[t]}__checkSingle(){const t=this;if(t.blendMode==="pass-through"){const s=this.__leaf;t.opacity<1&&(s.isBranch||t.__hasMultiPaint)||s.__hasEraser||t.eraser||t.filter?t.__single=!0:t.__single&&(t.__single=!1)}else t.__single=!0}__removeNaturalSize(){this.__naturalWidth=this.__naturalHeight=void 0}destroy(){this.__input=this.__middle=null}}const{round:_i,pow:pi,PI:ws}=Math,ct={within:(e,t,s)=>(j(t)&&(s=t.max,t=t.min),!w(t)&&e<t&&(e=t),!w(s)&&e>s&&(e=s),e),fourNumber(e,t){let s;if(Q(e))switch(e.length){case 4:s=w(t)?e:[...e];break;case 2:s=[e[0],e[1],e[0],e[1]];break;case 3:s=[e[0],e[1],e[2],e[1]];break;case 1:e=e[0];break;default:e=0}if(s||(s=[e,e,e,e]),t)for(let r=0;r<4;r++)s[r]>t&&(s[r]=t);return s},formatRotation:(e,t)=>(e%=360,t?e<0&&(e+=360):(e>180&&(e-=360),e<-180&&(e+=360)),ct.float(e)),getGapRotation(e,t,s=0){let r=e+s;if(t>1){const i=Math.abs(r%t);(i<1||i>t-1)&&(r=Math.round(r/t)*t)}return r-s},float(e,t){const s=w(t)?1e12:pi(10,t);return(e=_i(e*s)/s)===-0?0:e},sign:e=>e<0?-1:1,getScaleData(e,t,s,r){if(r||(r={}),t){const i=(Ft(t)?t:t.width||0)/s.width,n=(Ft(t)?t:t.height||0)/s.height;r.scaleX=i||n||1,r.scaleY=n||i||1}else e&&ct.assignScale(r,e);return r},assignScale(e,t){Ft(t)?e.scaleX=e.scaleY=t:(e.scaleX=t.x,e.scaleY=t.y)},randInt:se,randColor:e=>`rgba(${se(255)},${se(255)},${se(255)},${e||1})`};function se(e){return Math.round(Math.random()*e)}const P=ws/180,Z=2*ws,Dt=ws/2;function qa(){return{x:0,y:0}}function Qa(){return{x:0,y:0,width:0,height:0}}function fi(){return{a:1,b:0,c:0,d:1,e:0,f:0}}const{sin:Me,cos:Ae,acos:re,sqrt:We}=Math,{float:Et}=ct,It={};function Rs(){return Object.assign(Object.assign(Object.assign({},{a:1,b:0,c:0,d:1,e:0,f:0}),{x:0,y:0,width:0,height:0}),{scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0})}const b={defaultMatrix:{a:1,b:0,c:0,d:1,e:0,f:0},defaultWorld:Rs(),tempMatrix:{},set(e,t=1,s=0,r=0,i=1,n=0,o=0){e.a=t,e.b=s,e.c=r,e.d=i,e.e=n,e.f=o},get:fi,getWorld:Rs,copy(e,t){e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f},translate(e,t,s){e.e+=t,e.f+=s},translateInner(e,t,s,r){e.e+=e.a*t+e.c*s,e.f+=e.b*t+e.d*s,r&&(e.e-=t,e.f-=s)},scale(e,t,s=t){e.a*=t,e.b*=t,e.c*=s,e.d*=s},scaleOfOuter(e,t,s,r){E.toInnerPoint(e,t,It),E.scaleOfInner(e,It,s,r)},scaleOfInner(e,t,s,r=s){E.translateInner(e,t.x,t.y),E.scale(e,s,r),E.translateInner(e,-t.x,-t.y)},rotate(e,t){const{a:s,b:r,c:i,d:n}=e,o=Ae(t*=P),a=Me(t);e.a=s*o-r*a,e.b=s*a+r*o,e.c=i*o-n*a,e.d=i*a+n*o},rotateOfOuter(e,t,s){E.toInnerPoint(e,t,It),E.rotateOfInner(e,It,s)},rotateOfInner(e,t,s){E.translateInner(e,t.x,t.y),E.rotate(e,s),E.translateInner(e,-t.x,-t.y)},skew(e,t,s){const{a:r,b:i,c:n,d:o}=e;s&&(s*=P,e.a=r+n*s,e.b=i+o*s),t&&(t*=P,e.c=n+r*t,e.d=o+i*t)},skewOfOuter(e,t,s,r){E.toInnerPoint(e,t,It),E.skewOfInner(e,It,s,r)},skewOfInner(e,t,s,r=0){E.translateInner(e,t.x,t.y),E.skew(e,s,r),E.translateInner(e,-t.x,-t.y)},multiply(e,t){const{a:s,b:r,c:i,d:n,e:o,f:a}=e;e.a=t.a*s+t.b*i,e.b=t.a*r+t.b*n,e.c=t.c*s+t.d*i,e.d=t.c*r+t.d*n,e.e=t.e*s+t.f*i+o,e.f=t.e*r+t.f*n+a},multiplyParent(e,t,s,r,i){const{e:n,f:o}=e;if(s||(s=e),w(r)&&(r=e.a!==1||e.b||e.c||e.d!==1),r){const{a,b:l,c:u,d}=e;s.a=a*t.a+l*t.c,s.b=a*t.b+l*t.d,s.c=u*t.a+d*t.c,s.d=u*t.b+d*t.d,i&&(s.scaleX=t.scaleX*i.scaleX,s.scaleY=t.scaleY*i.scaleY)}else s.a=t.a,s.b=t.b,s.c=t.c,s.d=t.d,i&&(s.scaleX=t.scaleX,s.scaleY=t.scaleY);s.e=n*t.a+o*t.c+t.e,s.f=n*t.b+o*t.d+t.f},divide(e,t){E.multiply(e,E.tempInvert(t))},divideParent(e,t){E.multiplyParent(e,E.tempInvert(t))},tempInvert(e){const{tempMatrix:t}=E;return E.copy(t,e),E.invert(t),t},invert(e){const{a:t,b:s,c:r,d:i,e:n,f:o}=e;if(s||r){const a=1/(t*i-s*r);e.a=i*a,e.b=-s*a,e.c=-r*a,e.d=t*a,e.e=-(n*i-o*r)*a,e.f=-(o*t-n*s)*a}else if(t===1&&i===1)e.e=-n,e.f=-o;else{const a=1/(t*i);e.a=i*a,e.d=t*a,e.e=-n*i*a,e.f=-o*t*a}},toOuterPoint(e,t,s,r){const{x:i,y:n}=t;s||(s=t),s.x=i*e.a+n*e.c,s.y=i*e.b+n*e.d,r||(s.x+=e.e,s.y+=e.f)},toInnerPoint(e,t,s,r){const{a:i,b:n,c:o,d:a}=e,l=1/(i*a-n*o),{x:u,y:d}=t;if(s||(s=t),s.x=(u*a-d*o)*l,s.y=(d*i-u*n)*l,!r){const{e:h,f:_}=e;s.x-=(h*a-_*o)*l,s.y-=(_*i-h*n)*l}},setLayout(e,t,s,r,i){const{x:n,y:o,scaleX:a,scaleY:l}=t;if(w(i)&&(i=t.rotation||t.skewX||t.skewY),i){const{rotation:u,skewX:d,skewY:h}=t,_=u*P,c=Ae(_),y=Me(_);if(d||h){const x=d*P,g=h*P;e.a=(c+g*-y)*a,e.b=(y+g*c)*a,e.c=(x*c-y)*l,e.d=(c+x*y)*l}else e.a=c*a,e.b=y*a,e.c=-y*l,e.d=c*l}else e.a=a,e.b=0,e.c=0,e.d=l;e.e=n,e.f=o,(s=s||r)&&E.translateInner(e,-s.x,-s.y,!r)},getLayout(e,t,s,r){const{a:i,b:n,c:o,d:a,e:l,f:u}=e;let d,h,_,c,y,x=l,g=u;if(n||o){const k=i*a-n*o;if(o&&!r){d=We(i*i+n*n),h=k/d;const O=i/d;_=n>0?re(O):-re(O)}else{h=We(o*o+a*a),d=k/h;const O=o/h;_=Dt-(a>0?re(-O):-re(O))}const R=Et(Ae(_)),T=Me(_);d=Et(d),h=Et(h),c=R?Et((o/h+T)/R/P,9):0,y=R?Et((n/d-T)/R/P,9):0,_=Et(_/P)}else d=i,h=a,_=c=y=0;return(t=s||t)&&(x+=t.x*i+t.y*o,g+=t.x*n+t.y*a,s||(x-=t.x,g-=t.y)),{x,y:g,scaleX:d,scaleY:h,rotation:_,skewX:c,skewY:y}},withScale(e,t,s=t){const r=e;if(!t||!s){const{a:i,b:n,c:o,d:a}=e;n||o?s=(i*a-n*o)/(t=We(i*i+n*n)):(t=i,s=a)}return r.scaleX=t,r.scaleY=s,r},reset(e){E.set(e)}},E=b,{toInnerPoint:Ne,toOuterPoint:Ls}=b,{sin:Es,cos:Is,abs:Ms,sqrt:gi,atan2:yi,min:mi,round:ie}=Math,S={defaultPoint:{x:0,y:0},tempPoint:{},tempRadiusPoint:{},set(e,t=0,s=0){e.x=t,e.y=s},setRadius(e,t,s){e.radiusX=t,e.radiusY=w(s)?t:s},copy(e,t){e.x=t.x,e.y=t.y},copyFrom(e,t,s){e.x=t,e.y=s},round(e,t){e.x=t?ie(e.x-.5)+.5:ie(e.x),e.y=t?ie(e.y-.5)+.5:ie(e.y)},move(e,t,s){j(t)?(e.x+=t.x,e.y+=t.y):(e.x+=t,e.y+=s)},scale(e,t,s=t){e.x&&(e.x*=t),e.y&&(e.y*=s)},scaleOf(e,t,s,r=s){e.x+=(e.x-t.x)*(s-1),e.y+=(e.y-t.y)*(r-1)},rotate(e,t,s){s||(s=Tt.defaultPoint);const r=Is(t*=P),i=Es(t),n=e.x-s.x,o=e.y-s.y;e.x=s.x+n*r-o*i,e.y=s.y+n*i+o*r},tempToInnerOf(e,t){const{tempPoint:s}=Tt;return Xe(s,e),Ne(t,s,s),s},tempToOuterOf(e,t){const{tempPoint:s}=Tt;return Xe(s,e),Ls(t,s,s),s},tempToInnerRadiusPointOf(e,t){const{tempRadiusPoint:s}=Tt;return Xe(s,e),Tt.toInnerRadiusPointOf(e,t,s),s},toInnerRadiusPointOf(e,t,s){s||(s=e),Ne(t,e,s),s.radiusX=Math.abs(e.radiusX/t.scaleX),s.radiusY=Math.abs(e.radiusY/t.scaleY)},toInnerOf(e,t,s){Ne(t,e,s)},toOuterOf(e,t,s){Ls(t,e,s)},getCenter:(e,t)=>({x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}),getCenterX:(e,t)=>e+(t-e)/2,getCenterY:(e,t)=>e+(t-e)/2,getDistance:(e,t)=>Ye(e.x,e.y,t.x,t.y),getDistanceFrom(e,t,s,r){const i=Ms(s-e),n=Ms(r-t);return gi(i*i+n*n)},getMinDistanceFrom:(e,t,s,r,i,n)=>mi(Ye(e,t,s,r),Ye(s,r,i,n)),getAngle:(e,t)=>As(e,t)/P,getRotation:(e,t,s,r)=>(r||(r=t),Tt.getRadianFrom(e.x,e.y,t.x,t.y,s.x,s.y,r.x,r.y)/P),getRadianFrom(e,t,s,r,i,n,o,a){w(o)&&(o=s,a=r);const l=e-s,u=t-r,d=i-o,h=n-a;return Math.atan2(l*h-u*d,l*d+u*h)},getAtan2:(e,t)=>yi(t.y-e.y,t.x-e.x),getDistancePoint(e,t,s,r){const i=As(e,t);return(t=r?t:{}).x=e.x+Is(i)*s,t.y=e.y+Es(i)*s,t},toNumberPoints(e){let t=e;return j(e[0])&&(t=[],e.forEach(s=>t.push(s.x,s.y))),t},reset(e){}},Tt=S,{getDistanceFrom:Ye,copy:Xe,getAtan2:As}=Tt;class $t{constructor(t,s){this.set(t,s)}set(t,s){return j(t)?S.copy(this,t):S.set(this,t,s),this}get(){const{x:t,y:s}=this;return{x:t,y:s}}clone(){return new $t(this)}move(t,s){return S.move(this,t,s),this}scale(t,s){return S.scale(this,t,s),this}scaleOf(t,s,r){return S.scaleOf(this,t,s,r),this}rotate(t,s){return S.rotate(this,t,s),this}rotateOf(t,s){return S.rotate(this,s,t),this}getRotation(t,s,r){return S.getRotation(this,t,s,r)}toInnerOf(t,s){return S.toInnerOf(this,t,s),this}toOuterOf(t,s){return S.toOuterOf(this,t,s),this}getCenter(t){return new $t(S.getCenter(this,t))}getDistance(t){return S.getDistance(this,t)}getDistancePoint(t,s,r){return new $t(S.getDistancePoint(this,t,s,r))}getAngle(t){return S.getAngle(this,t)}getAtan2(t){return S.getAtan2(this,t)}reset(){return this}}new $t;class Pe{constructor(t,s,r,i,n,o){this.set(t,s,r,i,n,o)}set(t,s,r,i,n,o){return j(t)?b.copy(this,t):b.set(this,t,s,r,i,n,o),this}setWith(t){return b.copy(this,t),this.scaleX=t.scaleX,this.scaleY=t.scaleY,this}get(){const{a:t,b:s,c:r,d:i,e:n,f:o}=this;return{a:t,b:s,c:r,d:i,e:n,f:o}}clone(){return new Pe(this)}translate(t,s){return b.translate(this,t,s),this}translateInner(t,s){return b.translateInner(this,t,s),this}scale(t,s){return b.scale(this,t,s),this}scaleWith(t,s){return b.scale(this,t,s),this.scaleX*=t,this.scaleY*=s||t,this}scaleOfOuter(t,s,r){return b.scaleOfOuter(this,t,s,r),this}scaleOfInner(t,s,r){return b.scaleOfInner(this,t,s,r),this}rotate(t){return b.rotate(this,t),this}rotateOfOuter(t,s){return b.rotateOfOuter(this,t,s),this}rotateOfInner(t,s){return b.rotateOfInner(this,t,s),this}skew(t,s){return b.skew(this,t,s),this}skewOfOuter(t,s,r){return b.skewOfOuter(this,t,s,r),this}skewOfInner(t,s,r){return b.skewOfInner(this,t,s,r),this}multiply(t){return b.multiply(this,t),this}multiplyParent(t){return b.multiplyParent(this,t),this}divide(t){return b.divide(this,t),this}divideParent(t){return b.divideParent(this,t),this}invert(){return b.invert(this),this}invertWith(){return b.invert(this),this.scaleX=1/this.scaleX,this.scaleY=1/this.scaleY,this}toOuterPoint(t,s,r){b.toOuterPoint(this,t,s,r)}toInnerPoint(t,s,r){b.toInnerPoint(this,t,s,r)}setLayout(t,s,r){return b.setLayout(this,t,s,r),this}getLayout(t,s,r){return b.getLayout(this,t,s,r)}withScale(t,s){return b.withScale(this,t,s)}reset(){b.reset(this)}}new Pe;const Te={tempPointBounds:{},setPoint(e,t,s){e.minX=e.maxX=t,e.minY=e.maxY=s},addPoint(e,t,s){e.minX=t<e.minX?t:e.minX,e.minY=s<e.minY?s:e.minY,e.maxX=t>e.maxX?t:e.maxX,e.maxY=s>e.maxY?s:e.maxY},addBounds(e,t,s,r,i){Ws(e,t,s),Ws(e,t+r,s+i)},copy(e,t){e.minX=t.minX,e.minY=t.minY,e.maxX=t.maxX,e.maxY=t.maxY},addPointBounds(e,t){e.minX=t.minX<e.minX?t.minX:e.minX,e.minY=t.minY<e.minY?t.minY:e.minY,e.maxX=t.maxX>e.maxX?t.maxX:e.maxX,e.maxY=t.maxY>e.maxY?t.maxY:e.maxY},toBounds(e,t){t.x=e.minX,t.y=e.minY,t.width=e.maxX-e.minX,t.height=e.maxY-e.minY}},{addPoint:Ws}=Te;var Ns,cs;(function(e){e[e.top=0]="top",e[e.right=1]="right",e[e.bottom=2]="bottom",e[e.left=3]="left"})(Ns||(Ns={})),function(e){e[e.topLeft=0]="topLeft",e[e.top=1]="top",e[e.topRight=2]="topRight",e[e.right=3]="right",e[e.bottomRight=4]="bottomRight",e[e.bottom=5]="bottom",e[e.bottomLeft=6]="bottomLeft",e[e.left=7]="left",e[e.center=8]="center",e[e["top-left"]=0]="top-left",e[e["top-right"]=2]="top-right",e[e["bottom-right"]=4]="bottom-right",e[e["bottom-left"]=6]="bottom-left"}(cs||(cs={}));const bs=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:1,y:.5},{x:1,y:1},{x:.5,y:1},{x:0,y:1},{x:0,y:.5},{x:.5,y:.5}];bs.forEach(e=>e.type="percent");const Se={directionData:bs,tempPoint:{},get:Ys,toPoint(e,t,s,r,i,n){const o=Ys(e);s.x=o.x,s.y=o.y,o.type==="percent"&&(s.x*=t.width,s.y*=t.height,i&&(n||(s.x-=i.x,s.y-=i.y),o.x&&(s.x-=o.x===1?i.width:o.x===.5?o.x*i.width:0),o.y&&(s.y-=o.y===1?i.height:o.y===.5?o.y*i.height:0))),r||(s.x+=t.x,s.y+=t.y)},getPoint:(e,t,s)=>(s||(s={}),Se.toPoint(e,t,s,!0),s)};function Ys(e){return wt(e)?bs[cs[e]]:e}const{toPoint:xi}=Se,wi={toPoint(e,t,s,r,i,n){xi(e,s,r,i,t,n)}},{tempPointBounds:yt,setPoint:Xs,addPoint:ne,toBounds:Ds}=Te,{toOuterPoint:oe}=b,{float:ae,fourNumber:bi}=ct,{floor:zs,ceil:he}=Math;let tt,et,Bt,vt;const at={},G={},kt={},m={tempBounds:kt,set(e,t=0,s=0,r=0,i=0){e.x=t,e.y=s,e.width=r,e.height=i},copy(e,t){e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},copyAndSpread(e,t,s,r,i){const{x:n,y:o,width:a,height:l}=t;if(Q(s)){const u=bi(s);r?C.set(e,n+u[3],o+u[0],a-u[1]-u[3],l-u[2]-u[0]):C.set(e,n-u[3],o-u[0],a+u[1]+u[3],l+u[2]+u[0])}else r&&(s=-s),C.set(e,n-s,o-s,a+2*s,l+2*s);i&&(i==="width"?(e.y=o,e.height=l):(e.x=n,e.width=a))},minX:e=>e.width>0?e.x:e.x+e.width,minY:e=>e.height>0?e.y:e.y+e.height,maxX:e=>e.width>0?e.x+e.width:e.x,maxY:e=>e.height>0?e.y+e.height:e.y,move(e,t,s){e.x+=t,e.y+=s},scroll(e,t){e.x+=t.scrollX,e.y+=t.scrollY},getByMove:(e,t,s)=>(e=Object.assign({},e),C.move(e,t,s),e),toOffsetOutBounds(e,t,s){t?js(t,e):t=e,s?(t.offsetX=-(C.maxX(s)-e.x),t.offsetY=-(C.maxY(s)-e.y)):(t.offsetX=e.x+e.width,t.offsetY=e.y+e.height),C.move(t,-t.offsetX,-t.offsetY)},scale(e,t,s=t,r){r||S.scale(e,t,s),e.width*=t,e.height*=s},scaleOf(e,t,s,r=s){S.scaleOf(e,t,s,r),e.width*=s,e.height*=r},tempToOuterOf:(e,t)=>(C.copy(kt,e),C.toOuterOf(kt,t),kt),getOuterOf:(e,t)=>(e=Object.assign({},e),C.toOuterOf(e,t),e),toOuterOf(e,t,s){if(s||(s=e),t.b===0&&t.c===0){const{a:r,d:i}=t;r>0?(s.width=e.width*r,s.x=t.e+e.x*r):(s.width=e.width*-r,s.x=t.e+e.x*r-s.width),i>0?(s.height=e.height*i,s.y=t.f+e.y*i):(s.height=e.height*-i,s.y=t.f+e.y*i-s.height)}else at.x=e.x,at.y=e.y,oe(t,at,G),Xs(yt,G.x,G.y),at.x=e.x+e.width,oe(t,at,G),ne(yt,G.x,G.y),at.y=e.y+e.height,oe(t,at,G),ne(yt,G.x,G.y),at.x=e.x,oe(t,at,G),ne(yt,G.x,G.y),Ds(yt,s)},toInnerOf(e,t,s){s||(s=e),C.move(s,-t.e,-t.f),C.scale(s,1/t.a,1/t.d)},getFitMatrix(e,t,s=1){const r=Math.min(s,C.getFitScale(e,t));return new Pe(r,0,0,r,-t.x*r,-t.y*r)},getFitScale(e,t,s){const r=e.width/t.width,i=e.height/t.height;return s?Math.max(r,i):Math.min(r,i)},put(e,t,s="center",r=1,i=!0,n){n||(n=t),wt(r)&&(r=C.getFitScale(e,t,r==="cover")),kt.width=i?t.width*=r:t.width*r,kt.height=i?t.height*=r:t.height*r,wi.toPoint(s,kt,e,n,!0,!0)},getSpread(e,t,s){const r={};return C.copyAndSpread(r,e,t,!1,s),r},spread(e,t,s){C.copyAndSpread(e,e,t,!1,s)},shrink(e,t,s){C.copyAndSpread(e,e,t,!0,s)},ceil(e){const{x:t,y:s}=e;e.x=zs(e.x),e.y=zs(e.y),e.width=t>e.x?he(e.width+t-e.x):he(e.width),e.height=s>e.y?he(e.height+s-e.y):he(e.height)},unsign(e){e.width<0&&(e.x+=e.width,e.width=-e.width),e.height<0&&(e.y+=e.height,e.height=-e.height)},float(e,t){e.x=ae(e.x,t),e.y=ae(e.y,t),e.width=ae(e.width,t),e.height=ae(e.height,t)},add(e,t,s){tt=e.x+e.width,et=e.y+e.height,Bt=t.x,vt=t.y,s||(Bt+=t.width,vt+=t.height),tt=tt>Bt?tt:Bt,et=et>vt?et:vt,e.x=e.x<t.x?e.x:t.x,e.y=e.y<t.y?e.y:t.y,e.width=tt-e.x,e.height=et-e.y},addList(e,t){C.setListWithFn(e,t,void 0,!0)},setList(e,t,s=!1){C.setListWithFn(e,t,void 0,s)},addListWithFn(e,t,s){C.setListWithFn(e,t,s,!0)},setListWithFn(e,t,s,r=!1){let i,n=!0;for(let o=0,a=t.length;o<a;o++)i=s?s(t[o],o):t[o],i&&(i.width||i.height)&&(n?(n=!1,r||js(e,i)):Fs(e,i));n&&C.reset(e)},setPoints(e,t){t.forEach((s,r)=>r===0?Xs(yt,s.x,s.y):ne(yt,s.x,s.y)),Ds(yt,e)},setPoint(e,t){C.set(e,t.x,t.y)},addPoint(e,t){Fs(e,t,!0)},getPoints(e){const{x:t,y:s,width:r,height:i}=e;return[{x:t,y:s},{x:t+r,y:s},{x:t+r,y:s+i},{x:t,y:s+i}]},hitRadiusPoint:(e,t,s)=>(s&&(t=S.tempToInnerRadiusPointOf(t,s)),t.x>=e.x-t.radiusX&&t.x<=e.x+e.width+t.radiusX&&t.y>=e.y-t.radiusY&&t.y<=e.y+e.height+t.radiusY),hitPoint:(e,t,s)=>(s&&(t=S.tempToInnerOf(t,s)),t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height),hit:(e,t,s)=>(s&&(t=C.tempToOuterOf(t,s)),!(e.y+e.height<t.y||t.y+t.height<e.y||e.x+e.width<t.x||t.x+t.width<e.x)),includes:(e,t,s)=>(s&&(t=C.tempToOuterOf(t,s)),e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height),getIntersectData(e,t,s){if(s&&(t=C.tempToOuterOf(t,s)),!C.hit(e,t))return{x:0,y:0,width:0,height:0};let{x:r,y:i,width:n,height:o}=t;return tt=r+n,et=i+o,Bt=e.x+e.width,vt=e.y+e.height,r=r>e.x?r:e.x,i=i>e.y?i:e.y,tt=tt<Bt?tt:Bt,et=et<vt?et:vt,n=tt-r,o=et-i,{x:r,y:i,width:n,height:o}},intersect(e,t,s){C.copy(e,C.getIntersectData(e,t,s))},isSame:(e,t)=>e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height,isEmpty:e=>e.x===0&&e.y===0&&e.width===0&&e.height===0,reset(e){C.set(e)}},C=m,{add:Fs,copy:js}=C;class _t{get minX(){return m.minX(this)}get minY(){return m.minY(this)}get maxX(){return m.maxX(this)}get maxY(){return m.maxY(this)}constructor(t,s,r,i){this.set(t,s,r,i)}set(t,s,r,i){return j(t)?m.copy(this,t):m.set(this,t,s,r,i),this}get(){const{x:t,y:s,width:r,height:i}=this;return{x:t,y:s,width:r,height:i}}clone(){return new _t(this)}move(t,s){return m.move(this,t,s),this}scale(t,s,r){return m.scale(this,t,s,r),this}scaleOf(t,s,r){return m.scaleOf(this,t,s,r),this}toOuterOf(t,s){return m.toOuterOf(this,t,s),this}toInnerOf(t,s){return m.toInnerOf(this,t,s),this}getFitMatrix(t,s){return m.getFitMatrix(this,t,s)}put(t,s,r){m.put(this,t,s,r)}spread(t,s){return m.spread(this,t,s),this}shrink(t,s){return m.shrink(this,t,s),this}ceil(){return m.ceil(this),this}unsign(){return m.unsign(this),this}float(t){return m.float(this,t),this}add(t){return m.add(this,t),this}addList(t){return m.setList(this,t,!0),this}setList(t){return m.setList(this,t),this}addListWithFn(t,s){return m.setListWithFn(this,t,s,!0),this}setListWithFn(t,s){return m.setListWithFn(this,t,s),this}setPoint(t){return m.setPoint(this,t),this}setPoints(t){return m.setPoints(this,t),this}addPoint(t){return m.addPoint(this,t),this}getPoints(){return m.getPoints(this)}hitPoint(t,s){return m.hitPoint(this,t,s)}hitRadiusPoint(t,s){return m.hitRadiusPoint(this,t,s)}hit(t,s){return m.hit(this,t,s)}includes(t,s){return m.includes(this,t,s)}intersect(t,s){return m.intersect(this,t,s),this}getIntersect(t,s){return new _t(m.getIntersectData(this,t,s))}isSame(t){return m.isSame(this,t)}isEmpty(){return m.isEmpty(this)}reset(){m.reset(this)}}const Ja=new _t;class Za{constructor(t,s,r,i,n,o){j(t)?this.copy(t):this.set(t,s,r,i,n,o)}set(t=0,s=0,r=0,i=0,n=0,o=0){this.top=t,this.right=s,this.bottom=r,this.left=i,this.width=n,this.height=o}copy(t){const{top:s,right:r,bottom:i,left:n,width:o,height:a}=t;this.set(s,r,i,n,o,a)}getBoundsFrom(t){const{top:s,right:r,bottom:i,left:n,width:o,height:a}=this;return new _t(n,s,o||t.width-n-r,a||t.height-s-i)}}const Bi={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,".":1,e:1,E:1},{randColor:Us}=ct;class A{constructor(t){this.repeatMap={},this.name=t}static get(t){return new A(t)}static set filter(t){this.filterList=Hs(t)}static set exclude(t){this.excludeList=Hs(t)}static drawRepaint(t,s){const r=Us();t.fillWorld(s,r.replace("1)",".1)")),t.strokeWorld(s,r)}static drawBounds(t,s,r){const i=A.showBounds==="hit",n=t.__nowWorld,o=Us();i&&(s.setWorld(n),t.__drawHitPath(s),s.fillStyle=o.replace("1)",".2)"),s.fill()),s.resetTransform(),s.setStroke(o,2),i?s.stroke():s.strokeWorld(n,o)}log(...t){if(Ct.enable){if(Ct.filterList.length&&Ct.filterList.every(s=>s!==this.name)||Ct.excludeList.length&&Ct.excludeList.some(s=>s===this.name))return;console.log("%c"+this.name,"color:#21ae62",...t)}}tip(...t){Ct.enable&&this.warn(...t)}warn(...t){Ct.showWarn&&console.warn(this.name,...t)}repeat(t,...s){this.repeatMap[t]||(this.warn("repeat:"+t,...s),this.repeatMap[t]=!0)}error(...t){try{throw new Error}catch(s){console.error(this.name,...t,s)}}}function Hs(e){return e?wt(e)&&(e=[e]):e=[],e}A.filterList=[],A.excludeList=[],A.showWarn=!0;const Ct=A,vi=A.get("RunTime"),ki={currentId:0,currentName:"",idMap:{},nameMap:{},nameToIdMap:{},start(e,t){const s=dt.create(dt.RUNTIME);return V.currentId=V.idMap[s]=t?performance.now():Date.now(),V.currentName=V.nameMap[s]=e,V.nameToIdMap[e]=s,s},end(e,t){const s=V.idMap[e],r=V.nameMap[e],i=t?(performance.now()-s)/1e3:Date.now()-s;V.idMap[e]=V.nameMap[e]=V.nameToIdMap[r]=void 0,vi.log(r,i,"ms")},endOfName(e,t){const s=V.nameToIdMap[e];w(s)||V.end(s,t)}},V=ki,Hr=[],Be={list:{},add(e,...t){this.list[e]=!0,Hr.push(...t)},has(e,t){const s=this.list[e];return!s&&t&&this.need(e),s},need(e){console.error("please install and import plugin: "+(e.includes("-x")?"":"@leafer-in/")+e)}};setTimeout(()=>Hr.forEach(e=>Be.has(e,!0)));const Re={editor:e=>Be.need("editor")},Gs=A.get("UICreator"),Bs={list:{},register(e){const{__tag:t}=e.prototype;le[t]&&Gs.repeat(t),le[t]=e},get(e,t,s,r,i,n){le[e]||Gs.error("not register "+e);const o=new le[e](t);return w(s)||(o.x=s,r&&(o.y=r),i&&(o.width=i),n&&(o.height=n)),o}},{list:le}=Bs,Ci=A.get("EventCreator"),ve={nameList:{},register(e){let t;Object.keys(e).forEach(s=>{t=e[s],wt(t)&&(Ht[t]&&Ci.repeat(t),Ht[t]=e)})},changeName(e,t){const s=Ht[e];if(s){const r=Object.keys(s).find(i=>s[i]===e);r&&(s[r]=t,Ht[t]=s)}},has(e){return!!this.nameList[e]},get:(e,...t)=>new Ht[e](...t)},{nameList:Ht}=ve;class $a{constructor(){this.list=[]}add(t){t.manager=this,this.list.push(t)}get(t){let s;const{list:r}=this;for(let n=0,o=r.length;n<o;n++)if(s=r[n],s.recycled&&s.isSameSize(t))return s.recycled=!1,s.manager||(s.manager=this),s;const i=Re.canvas(t);return this.add(i),i}recycle(t){t.recycled=!0}clearRecycled(){let t;const s=[];for(let r=0,i=this.list.length;r<i;r++)t=this.list[r],t.recycled?t.destroy():s.push(t);this.list=s}clear(){this.list.forEach(t=>{t.destroy()}),this.list.length=0}destroy(){this.clear()}}function p(e,t,s,r){var i,n=arguments.length,o=n<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,s):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o}function Gr(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(u){try{l(r.next(u))}catch(d){n(d)}}function a(u){try{l(r.throw(u))}catch(d){n(d)}}function l(u){var d;u.done?i(u.value):(d=u.value,d instanceof s?d:new s(function(h){h(d)})).then(o,a)}l((r=r.apply(e,[])).next())})}function L(e){return(t,s)=>{e||(e=s);const r={get(){return this.context[e]},set(i){this.context[e]=i}};s==="strokeCap"&&(r.set=function(i){this.context[e]=i==="none"?"butt":i}),Object.defineProperty(t,s,r)}}const Vr=[];function B(){return(e,t)=>{Vr.push(t)}}const Oi=[];class f{set blendMode(t){t==="normal"&&(t="source-over"),this.context.globalCompositeOperation=t}get blendMode(){return this.context.globalCompositeOperation}set dashPattern(t){this.context.setLineDash(t||Oi)}get dashPattern(){return this.context.getLineDash()}__bindContext(){let t;Vr.forEach(s=>{t=this.context[s],t&&(this[s]=t.bind(this.context))}),this.textBaseline="alphabetic"}setTransform(t,s,r,i,n,o){}resetTransform(){}getTransform(){}save(){}restore(){}transform(t,s,r,i,n,o){j(t)?this.context.transform(t.a,t.b,t.c,t.d,t.e,t.f):this.context.transform(t,s,r,i,n,o)}translate(t,s){}scale(t,s){}rotate(t){}fill(t,s){}stroke(t){}clip(t,s){}fillRect(t,s,r,i){}strokeRect(t,s,r,i){}clearRect(t,s,r,i){}drawImage(t,s,r,i,n,o,a,l,u){switch(arguments.length){case 9:if(s<0){const d=-s/i*l;i+=s,s=0,o+=d,l-=d}if(r<0){const d=-r/n*u;n+=r,r=0,a+=d,u-=d}this.context.drawImage(t,s,r,i,n,o,a,l,u);break;case 5:this.context.drawImage(t,s,r,i,n);break;case 3:this.context.drawImage(t,s,r)}}beginPath(){}moveTo(t,s){}lineTo(t,s){}bezierCurveTo(t,s,r,i,n,o){}quadraticCurveTo(t,s,r,i){}closePath(){}arc(t,s,r,i,n,o){}arcTo(t,s,r,i,n){}ellipse(t,s,r,i,n,o,a,l){}rect(t,s,r,i){}roundRect(t,s,r,i,n){}createConicGradient(t,s,r){}createLinearGradient(t,s,r,i){}createPattern(t,s){}createRadialGradient(t,s,r,i,n,o){}fillText(t,s,r,i){}measureText(t){}strokeText(t,s,r,i){}destroy(){this.context=null}}p([L("imageSmoothingEnabled")],f.prototype,"smooth",void 0),p([L("imageSmoothingQuality")],f.prototype,"smoothLevel",void 0),p([L("globalAlpha")],f.prototype,"opacity",void 0),p([L()],f.prototype,"fillStyle",void 0),p([L()],f.prototype,"strokeStyle",void 0),p([L("lineWidth")],f.prototype,"strokeWidth",void 0),p([L("lineCap")],f.prototype,"strokeCap",void 0),p([L("lineJoin")],f.prototype,"strokeJoin",void 0),p([L("lineDashOffset")],f.prototype,"dashOffset",void 0),p([L()],f.prototype,"miterLimit",void 0),p([L()],f.prototype,"shadowBlur",void 0),p([L()],f.prototype,"shadowColor",void 0),p([L()],f.prototype,"shadowOffsetX",void 0),p([L()],f.prototype,"shadowOffsetY",void 0),p([L()],f.prototype,"filter",void 0),p([L()],f.prototype,"font",void 0),p([L()],f.prototype,"fontKerning",void 0),p([L()],f.prototype,"fontStretch",void 0),p([L()],f.prototype,"fontVariantCaps",void 0),p([L()],f.prototype,"textAlign",void 0),p([L()],f.prototype,"textBaseline",void 0),p([L()],f.prototype,"textRendering",void 0),p([L()],f.prototype,"wordSpacing",void 0),p([L()],f.prototype,"letterSpacing",void 0),p([L()],f.prototype,"direction",void 0),p([B()],f.prototype,"setTransform",null),p([B()],f.prototype,"resetTransform",null),p([B()],f.prototype,"getTransform",null),p([B()],f.prototype,"save",null),p([B()],f.prototype,"restore",null),p([B()],f.prototype,"translate",null),p([B()],f.prototype,"scale",null),p([B()],f.prototype,"rotate",null),p([B()],f.prototype,"fill",null),p([B()],f.prototype,"stroke",null),p([B()],f.prototype,"clip",null),p([B()],f.prototype,"fillRect",null),p([B()],f.prototype,"strokeRect",null),p([B()],f.prototype,"clearRect",null),p([B()],f.prototype,"beginPath",null),p([B()],f.prototype,"moveTo",null),p([B()],f.prototype,"lineTo",null),p([B()],f.prototype,"bezierCurveTo",null),p([B()],f.prototype,"quadraticCurveTo",null),p([B()],f.prototype,"closePath",null),p([B()],f.prototype,"arc",null),p([B()],f.prototype,"arcTo",null),p([B()],f.prototype,"ellipse",null),p([B()],f.prototype,"rect",null),p([B()],f.prototype,"roundRect",null),p([B()],f.prototype,"createConicGradient",null),p([B()],f.prototype,"createLinearGradient",null),p([B()],f.prototype,"createPattern",null),p([B()],f.prototype,"createRadialGradient",null),p([B()],f.prototype,"fillText",null),p([B()],f.prototype,"measureText",null),p([B()],f.prototype,"strokeText",null);const{copy:Pi,multiplyParent:Ti}=b,{round:ue}=Math,v=new _t,Vs=new _t,Si={width:1,height:1,pixelRatio:1},qs=["width","height","pixelRatio"];class Ka extends f{get width(){return this.size.width}get height(){return this.size.height}get pixelRatio(){return this.size.pixelRatio}get pixelWidth(){return this.width*this.pixelRatio||0}get pixelHeight(){return this.height*this.pixelRatio||0}get pixelSnap(){return this.config.pixelSnap}set pixelSnap(t){this.config.pixelSnap=t}get allowBackgroundColor(){return this.view&&this.parentView}constructor(t,s){super(),this.size={},this.worldTransform={},t||(t=Si),this.manager=s,this.innerId=dt.create(dt.CNAVAS);const{width:r,height:i,pixelRatio:n}=t;this.autoLayout=!r||!i,this.size.pixelRatio=n||J.devicePixelRatio,this.config=t,this.init()}init(){}__createContext(){const{view:t}=this,{contextSettings:s}=this.config;this.context=s?t.getContext("2d",s):t.getContext("2d"),this.__bindContext()}export(t,s){}toBlob(t,s){}toDataURL(t,s){}saveAs(t,s){}resize(t,s=!0){if(this.isSameSize(t))return;let r;this.context&&!this.unreal&&s&&this.width&&(r=this.getSameCanvas(),r.copyWorld(this));const i=this.size;te.copyAttrs(i,t,qs),qs.forEach(n=>i[n]||(i[n]=1)),this.bounds=new _t(0,0,this.width,this.height),this.updateViewSize(),this.updateClientBounds(),this.context&&(this.smooth=this.config.smooth,!this.unreal&&r&&(this.clearWorld(r.bounds),this.copyWorld(r),r.recycle()))}updateViewSize(){}updateClientBounds(){}getClientBounds(t){return t&&this.updateClientBounds(),this.clientBounds||this.bounds}startAutoLayout(t,s){}stopAutoLayout(){}setCursor(t){}setWorld(t,s){const{pixelRatio:r,pixelSnap:i}=this,n=this.worldTransform;s&&Ti(t,s,n),n.a=t.a*r,n.b=t.b*r,n.c=t.c*r,n.d=t.d*r,n.e=t.e*r,n.f=t.f*r,i&&(t.half&&t.half*r%2?(n.e=ue(n.e-.5)+.5,n.f=ue(n.f-.5)+.5):(n.e=ue(n.e),n.f=ue(n.f))),this.setTransform(n.a,n.b,n.c,n.d,n.e,n.f)}useWorldTransform(t){t&&(this.worldTransform=t);const s=this.worldTransform;s&&this.setTransform(s.a,s.b,s.c,s.d,s.e,s.f)}setStroke(t,s,r,i){s&&(this.strokeWidth=s),t&&(this.strokeStyle=t),r&&this.setStrokeOptions(r,i)}setStrokeOptions(t,s){let{strokeCap:r,strokeJoin:i,dashPattern:n,dashOffset:o,miterLimit:a}=t;s&&(s.strokeCap&&(r=s.strokeCap),s.strokeJoin&&(i=s.strokeJoin),w(s.dashPattern)||(n=s.dashPattern),w(s.dashOffset)||(o=s.dashOffset),s.miterLimit&&(a=s.miterLimit)),this.strokeCap=r,this.strokeJoin=i,this.dashPattern=n,this.dashOffset=o,this.miterLimit=a}saveBlendMode(t){this.savedBlendMode=this.blendMode,this.blendMode=t}restoreBlendMode(){this.blendMode=this.savedBlendMode}hitFill(t,s){return!0}hitStroke(t,s){return!0}hitPixel(t,s,r=1){return!0}setWorldShadow(t,s,r,i){const{pixelRatio:n}=this;this.shadowOffsetX=t*n,this.shadowOffsetY=s*n,this.shadowBlur=r*n,this.shadowColor=i||"black"}setWorldBlur(t){const{pixelRatio:s}=this;this.filter=`blur(${t*s}px)`}copyWorld(t,s,r,i,n=!0){i&&(this.blendMode=i),s?(this.setTempPixelBounds(s,n),r?(this.setTempPixelBounds2(r,n),r=Vs):r=v,this.drawImage(t.view,v.x,v.y,v.width,v.height,r.x,r.y,r.width,r.height)):this.drawImage(t.view,0,0),i&&(this.blendMode="source-over")}copyWorldToInner(t,s,r,i,n=!0){s.b||s.c?(this.save(),this.resetTransform(),this.copyWorld(t,s,m.tempToOuterOf(r,s),i,n),this.restore()):(i&&(this.blendMode=i),this.setTempPixelBounds(s,n),this.drawImage(t.view,v.x,v.y,v.width,v.height,r.x,r.y,r.width,r.height),i&&(this.blendMode="source-over"))}copyWorldByReset(t,s,r,i,n,o=!0){this.resetTransform(),this.copyWorld(t,s,r,i,o),n||this.useWorldTransform()}useGrayscaleAlpha(t){let s,r;this.setTempPixelBounds(t,!0,!0);const{context:i}=this,n=i.getImageData(v.x,v.y,v.width,v.height),{data:o}=n;for(let a=0,l=o.length;a<l;a+=4)r=.299*o[a]+.587*o[a+1]+.114*o[a+2],(s=o[a+3])&&(o[a+3]=s===255?r:s*(r/255));i.putImageData(n,v.x,v.y)}useMask(t,s,r){this.copyWorld(t,s,r,"destination-in")}useEraser(t,s,r){this.copyWorld(t,s,r,"destination-out")}fillWorld(t,s,r,i){r&&(this.blendMode=r),this.fillStyle=s,this.setTempPixelBounds(t,i),this.fillRect(v.x,v.y,v.width,v.height),r&&(this.blendMode="source-over")}strokeWorld(t,s,r,i){r&&(this.blendMode=r),this.strokeStyle=s,this.setTempPixelBounds(t,i),this.strokeRect(v.x,v.y,v.width,v.height),r&&(this.blendMode="source-over")}clipWorld(t,s=!0){this.beginPath(),this.setTempPixelBounds(t,s),this.rect(v.x,v.y,v.width,v.height),this.clip()}clipUI(t){t.windingRule?this.clip(t.windingRule):this.clip()}clearWorld(t,s=!0){this.setTempPixelBounds(t,s),this.clearRect(v.x,v.y,v.width,v.height)}clear(){const{pixelRatio:t}=this;this.clearRect(0,0,this.width*t+2,this.height*t+2)}setTempPixelBounds(t,s,r){this.copyToPixelBounds(v,t,s,r)}setTempPixelBounds2(t,s,r){this.copyToPixelBounds(Vs,t,s,r)}copyToPixelBounds(t,s,r,i){t.set(s),i&&t.intersect(this.bounds),t.scale(this.pixelRatio),r&&t.ceil()}isSameSize(t){return this.width===t.width&&this.height===t.height&&(!t.pixelRatio||this.pixelRatio===t.pixelRatio)}getSameCanvas(t,s){const{size:r,pixelSnap:i}=this,n=this.manager?this.manager.get(r):Re.canvas(Object.assign({},r));return n.save(),t&&(Pi(n.worldTransform,this.worldTransform),n.useWorldTransform()),s&&(n.smooth=this.smooth),n.pixelSnap!==i&&(n.pixelSnap=i),n}recycle(t){this.recycled||(this.restore(),t?this.clearWorld(t):this.clear(),this.manager?this.manager.recycle(this):this.destroy())}updateRender(t){}unrealCanvas(){}destroy(){this.manager=this.view=this.parentView=null}}const rt={creator:{},parse(e,t){},convertToCanvasData(e,t){}},qr={N:21,D:22,X:23,G:24,F:25,O:26,P:27,U:28},$=Object.assign({M:1,m:10,L:2,l:20,H:3,h:30,V:4,v:40,C:5,c:50,S:6,s:60,Q:7,q:70,T:8,t:80,A:9,a:90,Z:11,z:11,R:12},qr),Qr={M:3,m:3,L:3,l:3,H:2,h:2,V:2,v:2,C:7,c:7,S:5,s:5,Q:5,q:5,T:3,t:3,A:8,a:8,Z:1,z:1,N:5,D:9,X:6,G:9,F:5,O:7,P:4,U:6},Jr={m:10,l:20,H:3,h:30,V:4,v:40,c:50,S:6,s:60,q:70,T:8,t:80,A:9,a:90},Ri=Object.assign(Object.assign({},Jr),qr),ke=$,Zr={};for(let e in ke)Zr[ke[e]]=e;const vs={};for(let e in ke)vs[ke[e]]=Qr[e];const $r={drawRoundRect(e,t,s,r,i,n){const o=ct.fourNumber(n,Math.min(r/2,i/2)),a=t+r,l=s+i;o[0]?e.moveTo(t+o[0],s):e.moveTo(t,s),o[1]?e.arcTo(a,s,a,l,o[1]):e.lineTo(a,s),o[2]?e.arcTo(a,l,t,l,o[2]):e.lineTo(a,l),o[3]?e.arcTo(t,l,t,s,o[3]):e.lineTo(t,l),o[0]?e.arcTo(t,s,a,s,o[0]):e.lineTo(t,s)}},{sin:Mt,cos:Gt,hypot:Qs,atan2:Js,ceil:Li,abs:Zs,PI:$s,sqrt:Ks,pow:de}=Math,{setPoint:De,addPoint:ce}=Te,{set:_e,toNumberPoints:Ei}=S,{M:tr,L:ze,C:Fe,Q:er,Z:Ii}=$,je={},Rt={points(e,t,s,r){let i=Ei(t);if(e.push(tr,i[0],i[1]),s&&i.length>5){let n,o,a,l,u,d,h,_,c,y,x,g,k,R=i.length;const T=s===!0?.5:s;r&&(i=[i[R-2],i[R-1],...i,i[0],i[1],i[2],i[3]],R=i.length);for(let O=2;O<R-2;O+=2)n=i[O-2],o=i[O-1],a=i[O],l=i[O+1],u=i[O+2],d=i[O+3],x=Ks(de(a-n,2)+de(l-o,2)),g=Ks(de(u-a,2)+de(d-l,2)),(x||g)&&(k=x+g,x=T*x/k,g=T*g/k,u-=n,d-=o,h=a-x*u,_=l-x*d,O===2?r||e.push(er,h,_,a,l):e.push(Fe,c,y,h,_,a,l),c=a+g*u,y=l+g*d);r||e.push(er,c,y,i[R-2],i[R-1])}else for(let n=2,o=i.length;n<o;n+=2)e.push(ze,i[n],i[n+1]);r&&e.push(Ii)},rect(e,t,s,r,i){rt.creator.path=e,rt.creator.moveTo(t,s).lineTo(t+r,s).lineTo(t+r,s+i).lineTo(t,s+i).lineTo(t,s)},roundRect(e,t,s,r,i,n){rt.creator.path=[],$r.drawRoundRect(rt.creator,t,s,r,i,n),e.push(...rt.convertToCanvasData(rt.creator.path,!0))},arcTo(e,t,s,r,i,n,o,a,l,u,d){const h=r-t,_=i-s,c=n-r,y=o-i;let x=Js(_,h),g=Js(y,c);const k=Qs(h,_),R=Qs(c,y);let T=g-x;if(T<0&&(T+=Z),k<1e-12||R<1e-12||T<1e-12||Zs(T-$s)<1e-12)return e&&e.push(ze,r,i),l&&(De(l,t,s),ce(l,r,i)),d&&_e(d,t,s),void(u&&_e(u,r,i));const O=h*y-c*_<0,z=O?-1:1,F=a/Gt(T/2),W=r+F*Gt(x+T/2+Dt*z),D=i+F*Mt(x+T/2+Dt*z);return x-=Dt*z,g-=Dt*z,ir(e,W,D,a,a,0,x/P,g/P,O,l,u,d)},arc:(e,t,s,r,i,n,o,a,l,u)=>ir(e,t,s,r,r,0,i,n,o,a,l,u),ellipse(e,t,s,r,i,n,o,a,l,u,d,h){const _=n*P,c=Mt(_),y=Gt(_);let x=o*P,g=a*P;x>$s&&(x-=Z),g<0&&(g+=Z);let k=g-x;k<0?k+=Z:k>Z&&(k-=Z),l&&(k-=Z);const R=Li(Zs(k/Dt)),T=k/R,O=Mt(T/4),z=8/3*O*O/Mt(T/2);g=x+T;let F,W,D,U,ft,gt,it,bt,nt=Gt(x),ot=Mt(x),Lt=D=y*r*nt-c*i*ot,Le=U=c*r*nt+y*i*ot,Ee=t+D,Ie=s+U;e&&e.push(e.length?ze:tr,Ee,Ie),u&&De(u,Ee,Ie),h&&_e(h,Ee,Ie);for(let Ts=0;Ts<R;Ts++)F=Gt(g),W=Mt(g),D=y*r*F-c*i*W,U=c*r*F+y*i*W,ft=t+Lt-z*(y*r*ot+c*i*nt),gt=s+Le-z*(c*r*ot-y*i*nt),it=t+D+z*(y*r*W+c*i*F),bt=s+U+z*(c*r*W-y*i*F),e&&e.push(Fe,ft,gt,it,bt,t+D,s+U),u&&rr(t+Lt,s+Le,ft,gt,it,bt,t+D,s+U,u,!0),Lt=D,Le=U,nt=F,ot=W,x=g,g+=T;d&&_e(d,t+D,s+U)},quadraticCurveTo(e,t,s,r,i,n,o){e.push(Fe,(t+2*r)/3,(s+2*i)/3,(n+2*r)/3,(o+2*i)/3,n,o)},toTwoPointBoundsByQuadraticCurve(e,t,s,r,i,n,o,a){rr(e,t,(e+2*s)/3,(t+2*r)/3,(i+2*s)/3,(n+2*r)/3,i,n,o,a)},toTwoPointBounds(e,t,s,r,i,n,o,a,l,u){const d=[];let h,_,c,y,x,g,k,R,T=e,O=s,z=i,F=o;for(let W=0;W<2;++W)if(W==1&&(T=t,O=r,z=n,F=a),h=-3*T+9*O-9*z+3*F,_=6*T-12*O+6*z,c=3*O-3*T,Math.abs(h)<1e-12){if(Math.abs(_)<1e-12)continue;y=-c/_,0<y&&y<1&&d.push(y)}else k=_*_-4*c*h,R=Math.sqrt(k),k<0||(x=(-_+R)/(2*h),0<x&&x<1&&d.push(x),g=(-_-R)/(2*h),0<g&&g<1&&d.push(g));u?ce(l,e,t):De(l,e,t),ce(l,o,a);for(let W=0,D=d.length;W<D;W++)sr(d[W],e,t,s,r,i,n,o,a,je),ce(l,je.x,je.y)},getPointAndSet(e,t,s,r,i,n,o,a,l,u){const d=1-e,h=d*d*d,_=3*d*d*e,c=3*d*e*e,y=e*e*e;u.x=h*t+_*r+c*n+y*a,u.y=h*s+_*i+c*o+y*l},getPoint(e,t,s,r,i,n,o,a,l){const u={};return sr(e,t,s,r,i,n,o,a,l,u),u},getDerivative(e,t,s,r,i){const n=1-e;return 3*n*n*(s-t)+6*n*e*(r-s)+3*e*e*(i-r)}},{getPointAndSet:sr,toTwoPointBounds:rr,ellipse:ir}=Rt,{sin:Mi,cos:Ai,sqrt:nr,atan2:or}=Math,{ellipse:Wi}=Rt,Ni={ellipticalArc(e,t,s,r,i,n,o,a,l,u,d){const h=(l-t)/2,_=(u-s)/2,c=n*P,y=Mi(c),x=Ai(c),g=-x*h-y*_,k=-x*_+y*h,R=r*r,T=i*i,O=k*k,z=g*g,F=R*T-R*O-T*z;let W=0;if(F<0){const Lt=nr(1-F/(R*T));r*=Lt,i*=Lt}else W=(o===a?-1:1)*nr(F/(R*O+T*z));const D=W*r*k/i,U=-W*i*g/r,ft=or((k-U)/i,(g-D)/r),gt=or((-k-U)/i,(-g-D)/r);let it=gt-ft;a===0&&it>0?it-=Z:a===1&&it<0&&(it+=Z);const bt=t+h+x*D-y*U,nt=s+_+y*D+x*U,ot=it<0?1:0;d||J.ellipseToCurve?Wi(e,bt,nt,r,i,n,ft/P,gt/P,ot):r!==i||n?e.push($.G,bt,nt,r,i,n,ft/P,gt/P,ot):e.push($.O,bt,nt,r,ft/P,gt/P,ot)}},{M:Ue,m:Yi,L:Vt,l:Xi,H:Di,h:zi,V:Fi,v:ji,C:At,c:Ui,S:He,s:Hi,Q:Wt,q:Gi,T:Ge,t:Vi,A:qi,a:Qi,Z:Ve,z:Ji,N:Zi,D:$i,X:Ki,G:tn,F:en,O:sn,P:rn,U:nn}=$,{rect:on,roundRect:ar,arcTo:an,arc:hr,ellipse:lr,quadraticCurveTo:ur}=Rt,{ellipticalArc:hn}=Ni,ln=A.get("PathConvert"),ht={},Ce={current:{dot:0},stringify(e,t){let s,r,i,n=0,o=e.length,a="";for(;n<o;){r=e[n],s=vs[r],a+=r===i?" ":Zr[r];for(let l=1;l<s;l++)a+=ct.float(e[n+l],t),l===s-1||(a+=" ");i=r,n+=s}return a},parse(e,t){let s,r,i,n="";const o=[],a=t?Ri:Jr;for(let l=0,u=e.length;l<u;l++)r=e[l],Bi[r]?(r==="."&&(q.dot&&(Ot(o,n),n=""),q.dot++),n==="0"&&r!=="."&&(Ot(o,n),n=""),n+=r):$[r]?(n&&(Ot(o,n),n=""),q.name=$[r],q.length=Qr[r],q.index=0,Ot(o,q.name),!s&&a[r]&&(s=!0)):r==="-"||r==="+"?i==="e"||i==="E"?n+=r:(n&&Ot(o,n),n=r):n&&(Ot(o,n),n=""),i=r;return n&&Ot(o,n),s?Ce.toCanvasData(o,t):o},toCanvasData(e,t){let s,r,i,n,o,a=0,l=0,u=0,d=0,h=0,_=e.length;const c=[];for(;h<_;){switch(i=e[h],i){case Yi:e[h+1]+=a,e[h+2]+=l;case Ue:a=e[h+1],l=e[h+2],c.push(Ue,a,l),h+=3;break;case zi:e[h+1]+=a;case Di:a=e[h+1],c.push(Vt,a,l),h+=2;break;case ji:e[h+1]+=l;case Fi:l=e[h+1],c.push(Vt,a,l),h+=2;break;case Xi:e[h+1]+=a,e[h+2]+=l;case Vt:a=e[h+1],l=e[h+2],c.push(Vt,a,l),h+=3;break;case Hi:e[h+1]+=a,e[h+2]+=l,e[h+3]+=a,e[h+4]+=l,i=He;case He:o=n===At||n===He,u=o?2*a-s:e[h+1],d=o?2*l-r:e[h+2],s=e[h+1],r=e[h+2],a=e[h+3],l=e[h+4],c.push(At,u,d,s,r,a,l),h+=5;break;case Ui:e[h+1]+=a,e[h+2]+=l,e[h+3]+=a,e[h+4]+=l,e[h+5]+=a,e[h+6]+=l,i=At;case At:s=e[h+3],r=e[h+4],a=e[h+5],l=e[h+6],c.push(At,e[h+1],e[h+2],s,r,a,l),h+=7;break;case Vi:e[h+1]+=a,e[h+2]+=l,i=Ge;case Ge:o=n===Wt||n===Ge,s=o?2*a-s:e[h+1],r=o?2*l-r:e[h+2],t?ur(c,a,l,s,r,e[h+1],e[h+2]):c.push(Wt,s,r,e[h+1],e[h+2]),a=e[h+1],l=e[h+2],h+=3;break;case Gi:e[h+1]+=a,e[h+2]+=l,e[h+3]+=a,e[h+4]+=l,i=Wt;case Wt:s=e[h+1],r=e[h+2],t?ur(c,a,l,s,r,e[h+3],e[h+4]):c.push(Wt,s,r,e[h+3],e[h+4]),a=e[h+3],l=e[h+4],h+=5;break;case Qi:e[h+6]+=a,e[h+7]+=l;case qi:hn(c,a,l,e[h+1],e[h+2],e[h+3],e[h+4],e[h+5],e[h+6],e[h+7],t),a=e[h+6],l=e[h+7],h+=8;break;case Ji:case Ve:c.push(Ve),h++;break;case Zi:a=e[h+1],l=e[h+2],t?on(c,a,l,e[h+3],e[h+4]):mt(c,e,h,5),h+=5;break;case $i:a=e[h+1],l=e[h+2],t?ar(c,a,l,e[h+3],e[h+4],[e[h+5],e[h+6],e[h+7],e[h+8]]):mt(c,e,h,9),h+=9;break;case Ki:a=e[h+1],l=e[h+2],t?ar(c,a,l,e[h+3],e[h+4],e[h+5]):mt(c,e,h,6),h+=6;break;case tn:lr(t?c:mt(c,e,h,9),e[h+1],e[h+2],e[h+3],e[h+4],e[h+5],e[h+6],e[h+7],e[h+8],null,ht),a=ht.x,l=ht.y,h+=9;break;case en:t?lr(c,e[h+1],e[h+2],e[h+3],e[h+4],0,0,360,!1):mt(c,e,h,5),a=e[h+1]+e[h+3],l=e[h+2],h+=5;break;case sn:hr(t?c:mt(c,e,h,7),e[h+1],e[h+2],e[h+3],e[h+4],e[h+5],e[h+6],null,ht),a=ht.x,l=ht.y,h+=7;break;case rn:t?hr(c,e[h+1],e[h+2],e[h+3],0,360,!1):mt(c,e,h,4),a=e[h+1]+e[h+3],l=e[h+2],h+=4;break;case nn:an(t?c:mt(c,e,h,6),a,l,e[h+1],e[h+2],e[h+3],e[h+4],e[h+5],null,ht),a=ht.x,l=ht.y,h+=6;break;default:return ln.error(`command: ${i} [index:${h}]`,e),c}n=i}return c},objectToCanvasData(e){const t=[];return e.forEach(s=>{switch(s.name){case"M":t.push(Ue,s.x,s.y);break;case"L":t.push(Vt,s.x,s.y);break;case"C":t.push(At,s.x1,s.y1,s.x2,s.y2,s.x,s.y);break;case"Q":t.push(Wt,s.x1,s.y1,s.x,s.y);break;case"Z":t.push(Ve)}}),t},copyData(e,t,s,r){for(let i=s,n=s+r;i<n;i++)e.push(t[i])},pushData(e,t){q.index===q.length&&(q.index=1,e.push(q.name)),e.push(Number(t)),q.index++,q.dot=0}},{current:q,pushData:Ot,copyData:mt}=Ce,{M:qe,L:un,C:dn,Q:cn,Z:_n,N:dr,D:pn,X:fn,G:gn,F:yn,O:mn,P:xn,U:wn}=$,{getMinDistanceFrom:bn,getRadianFrom:Bn}=S,{tan:vn,min:cr,abs:kn}=Math,Nt={},ks={beginPath(e){e.length=0},moveTo(e,t,s){e.push(qe,t,s)},lineTo(e,t,s){e.push(un,t,s)},bezierCurveTo(e,t,s,r,i,n,o){e.push(dn,t,s,r,i,n,o)},quadraticCurveTo(e,t,s,r,i){e.push(cn,t,s,r,i)},closePath(e){e.push(_n)},rect(e,t,s,r,i){e.push(dr,t,s,r,i)},roundRect(e,t,s,r,i,n){if(Ft(n))e.push(fn,t,s,r,i,n);else{const o=ct.fourNumber(n);o?e.push(pn,t,s,r,i,...o):e.push(dr,t,s,r,i)}},ellipse(e,t,s,r,i,n,o,a,l){K(n)?e.push(yn,t,s,r,i):(K(o)&&(o=0),K(a)&&(a=360),e.push(gn,t,s,r,i,n,o,a,l?1:0))},arc(e,t,s,r,i,n,o){K(i)?e.push(xn,t,s,r):(K(n)&&(n=360),e.push(mn,t,s,r,i,n,o?1:0))},arcTo(e,t,s,r,i,n,o,a){if(!w(o)){const l=bn(o,a,t,s,r,i);n=cr(n,cr(l/2,l/2*kn(vn(Bn(o,a,t,s,r,i)/2))))}e.push(wn,t,s,r,i,n)},drawEllipse(e,t,s,r,i,n,o,a,l){Rt.ellipse(null,t,s,r,i,K(n)?0:n,K(o)?0:o,K(a)?360:a,l,null,null,Nt),e.push(qe,Nt.x,Nt.y),Cn(e,t,s,r,i,n,o,a,l)},drawArc(e,t,s,r,i,n,o){Rt.arc(null,t,s,r,K(i)?0:i,K(n)?360:n,o,null,null,Nt),e.push(qe,Nt.x,Nt.y),On(e,t,s,r,i,n,o)},drawPoints(e,t,s,r){Rt.points(e,t,s,r)}},{ellipse:Cn,arc:On}=ks,{moveTo:Pn,lineTo:Tn,quadraticCurveTo:Sn,bezierCurveTo:Rn,closePath:Ln,beginPath:En,rect:In,roundRect:Mn,ellipse:An,arc:Wn,arcTo:Nn,drawEllipse:Yn,drawArc:Xn,drawPoints:Dn}=ks;class zn{set path(t){this.__path=t}get path(){return this.__path}constructor(t){this.set(t)}set(t){return this.__path=t?wt(t)?rt.parse(t):t:[],this}beginPath(){return En(this.__path),this.paint(),this}moveTo(t,s){return Pn(this.__path,t,s),this.paint(),this}lineTo(t,s){return Tn(this.__path,t,s),this.paint(),this}bezierCurveTo(t,s,r,i,n,o){return Rn(this.__path,t,s,r,i,n,o),this.paint(),this}quadraticCurveTo(t,s,r,i){return Sn(this.__path,t,s,r,i),this.paint(),this}closePath(){return Ln(this.__path),this.paint(),this}rect(t,s,r,i){return In(this.__path,t,s,r,i),this.paint(),this}roundRect(t,s,r,i,n){return Mn(this.__path,t,s,r,i,n),this.paint(),this}ellipse(t,s,r,i,n,o,a,l){return An(this.__path,t,s,r,i,n,o,a,l),this.paint(),this}arc(t,s,r,i,n,o){return Wn(this.__path,t,s,r,i,n,o),this.paint(),this}arcTo(t,s,r,i,n){return Nn(this.__path,t,s,r,i,n),this.paint(),this}drawEllipse(t,s,r,i,n,o,a,l){return Yn(this.__path,t,s,r,i,n,o,a,l),this.paint(),this}drawArc(t,s,r,i,n,o){return Xn(this.__path,t,s,r,i,n,o),this.paint(),this}drawPoints(t,s,r){return Dn(this.__path,t,s,r),this.paint(),this}clearPath(){return this.beginPath()}paint(){}}const{M:Fn,L:jn,C:Un,Q:Hn,Z:Gn,N:Vn,D:qn,X:Qn,G:Jn,F:Zn,O:$n,P:Kn,U:to}=$,eo=A.get("PathDrawer"),th={drawPathByData(e,t){if(!t)return;let s,r=0,i=t.length;for(;r<i;)switch(s=t[r],s){case Fn:e.moveTo(t[r+1],t[r+2]),r+=3;break;case jn:e.lineTo(t[r+1],t[r+2]),r+=3;break;case Un:e.bezierCurveTo(t[r+1],t[r+2],t[r+3],t[r+4],t[r+5],t[r+6]),r+=7;break;case Hn:e.quadraticCurveTo(t[r+1],t[r+2],t[r+3],t[r+4]),r+=5;break;case Gn:e.closePath(),r+=1;break;case Vn:e.rect(t[r+1],t[r+2],t[r+3],t[r+4]),r+=5;break;case qn:e.roundRect(t[r+1],t[r+2],t[r+3],t[r+4],[t[r+5],t[r+6],t[r+7],t[r+8]]),r+=9;break;case Qn:e.roundRect(t[r+1],t[r+2],t[r+3],t[r+4],t[r+5]),r+=6;break;case Jn:e.ellipse(t[r+1],t[r+2],t[r+3],t[r+4],t[r+5]*P,t[r+6]*P,t[r+7]*P,t[r+8]),r+=9;break;case Zn:e.ellipse(t[r+1],t[r+2],t[r+3],t[r+4],0,0,Z,!1),r+=5;break;case $n:e.arc(t[r+1],t[r+2],t[r+3],t[r+4]*P,t[r+5]*P,t[r+6]),r+=7;break;case Kn:e.arc(t[r+1],t[r+2],t[r+3],0,Z,!1),r+=4;break;case to:e.arcTo(t[r+1],t[r+2],t[r+3],t[r+4],t[r+5]),r+=6;break;default:return void eo.error(`command: ${s} [index:${r}]`,t)}}},{M:so,L:ro,C:_r,Q:pr,Z:fr,N:io,D:gr,X:no,G:oo,F:ao,O:ho,P:lo,U:uo}=$,{toTwoPointBounds:co,toTwoPointBoundsByQuadraticCurve:_o,arcTo:po,arc:fo,ellipse:go}=Rt,{addPointBounds:qt,copy:Qe,addPoint:yo,setPoint:Je,addBounds:pe,toBounds:mo}=Te,xo=A.get("PathBounds");let Yt,fe,Ze;const H={},yr={},lt={},Kr={toBounds(e,t){Kr.toTwoPointBounds(e,yr),mo(yr,t)},toTwoPointBounds(e,t){if(!e||!e.length)return Je(t,0,0);let s,r,i,n,o,a=0,l=0,u=0;const d=e.length;for(;a<d;)switch(o=e[a],a===0&&(o===fr||o===_r||o===pr?Je(t,l,u):Je(t,e[a+1],e[a+2])),o){case so:case ro:l=e[a+1],u=e[a+2],yo(t,l,u),a+=3;break;case _r:i=e[a+5],n=e[a+6],co(l,u,e[a+1],e[a+2],e[a+3],e[a+4],i,n,H),qt(t,H),l=i,u=n,a+=7;break;case pr:s=e[a+1],r=e[a+2],i=e[a+3],n=e[a+4],_o(l,u,s,r,i,n,H),qt(t,H),l=i,u=n,a+=5;break;case fr:a+=1;break;case io:l=e[a+1],u=e[a+2],pe(t,l,u,e[a+3],e[a+4]),a+=5;break;case gr:case no:l=e[a+1],u=e[a+2],pe(t,l,u,e[a+3],e[a+4]),a+=o===gr?9:6;break;case oo:go(null,e[a+1],e[a+2],e[a+3],e[a+4],e[a+5],e[a+6],e[a+7],e[a+8],H,lt),a===0?Qe(t,H):qt(t,H),l=lt.x,u=lt.y,a+=9;break;case ao:l=e[a+1],u=e[a+2],fe=e[a+3],Ze=e[a+4],pe(t,l-fe,u-Ze,2*fe,2*Ze),l+=fe,a+=5;break;case ho:fo(null,e[a+1],e[a+2],e[a+3],e[a+4],e[a+5],e[a+6],H,lt),a===0?Qe(t,H):qt(t,H),l=lt.x,u=lt.y,a+=7;break;case lo:l=e[a+1],u=e[a+2],Yt=e[a+3],pe(t,l-Yt,u-Yt,2*Yt,2*Yt),l+=Yt,a+=4;break;case uo:po(null,l,u,e[a+1],e[a+2],e[a+3],e[a+4],e[a+5],H,lt),a===0?Qe(t,H):qt(t,H),l=lt.x,u=lt.y,a+=6;break;default:return void xo.error(`command: ${o} [index:${a}]`,e)}}},{M:$e,L:ge,Z:Qt}=$,{getCenterX:wo,getCenterY:bo}=S,{arcTo:Ke}=ks,eh={smooth(e,t,s){let r,i,n,o=0,a=0,l=0,u=0,d=0,h=0,_=0,c=0,y=0;const x=e.length,g=[];for(;o<x;){switch(r=e[o],r){case $e:u=c=e[o+1],d=y=e[o+2],o+=3,e[o]===ge?(h=e[o+1],_=e[o+2],g.push($e,wo(u,h),bo(d,_))):g.push($e,u,d);break;case ge:switch(a=e[o+1],l=e[o+2],o+=3,e[o]){case ge:Ke(g,a,l,e[o+1],e[o+2],t,c,y);break;case Qt:Ke(g,a,l,u,d,t,c,y);break;default:g.push(ge,a,l)}c=a,y=l;break;case Qt:i!==Qt&&(Ke(g,u,d,h,_,t,c,y),g.push(Qt)),o+=1;break;default:n=vs[r];for(let k=0;k<n;k++)g.push(e[o+k]);o+=n}i=r}return r!==Qt&&(g[1]=u,g[2]=d),g}};function ti(e){return new zn(e)}const sh=ti();rt.creator=ti(),rt.parse=Ce.parse,rt.convertToCanvasData=Ce.toCanvasData;const{drawRoundRect:Bo}=$r;function rh(e){(function(t){t&&!t.roundRect&&(t.roundRect=function(s,r,i,n,o){Bo(this,s,r,i,n,o)})})(e)}const xe={alphaPixelTypes:["png","webp","svg"],upperCaseTypeMap:{},mineType:e=>!e||e.startsWith("image")?e:(e==="jpg"&&(e="jpeg"),"image/"+e),fileType(e){const t=e.split(".");return t[t.length-1]},isOpaqueImage(e){const t=_s.fileType(e);return["jpg","jpeg"].some(s=>s===t)},getExportOptions(e){switch(typeof e){case"object":return e;case"number":return{quality:e};case"boolean":return{blob:e};default:return{}}}},_s=xe;_s.alphaPixelTypes.forEach(e=>_s.upperCaseTypeMap[e]=e.toUpperCase());const vo=A.get("TaskProcessor");class ko{constructor(t){this.parallel=!0,this.time=1,this.id=dt.create(dt.TASK),this.task=t}run(){return Gr(this,void 0,void 0,function*(){try{this.task&&!this.isComplete&&this.parent.running&&(yield this.task())}catch(t){vo.error(t)}})}complete(){this.isComplete=!0,this.parent=null,this.task=null}cancel(){this.isCancel=!0,this.complete()}}class ei{get total(){return this.list.length+this.delayNumber}get finishedIndex(){return this.isComplete?0:this.index+this.parallelSuccessNumber}get remain(){return this.isComplete?this.total:this.total-this.finishedIndex}get percent(){const{total:t}=this;let s=0,r=0;for(let i=0;i<t;i++)i<=this.finishedIndex?(r+=this.list[i].time,i===this.finishedIndex&&(s=r)):s+=this.list[i].time;return this.isComplete?1:r/s}constructor(t){this.config={parallel:6},this.list=[],this.running=!1,this.isComplete=!0,this.index=0,this.delayNumber=0,t&&te.assign(this.config,t),this.empty()}add(t,s){let r,i,n,o;const a=new ko(t);return a.parent=this,Ft(s)?o=s:s&&(i=s.parallel,r=s.start,n=s.time,o=s.delay),n&&(a.time=n),i===!1&&(a.parallel=!1),w(o)?this.push(a,r):(this.delayNumber++,setTimeout(()=>{this.delayNumber&&(this.delayNumber--,this.push(a,r))},o)),this.isComplete=!1,a}push(t,s){this.list.push(t),s===!1||this.timer||(this.timer=setTimeout(()=>this.start()))}empty(){this.index=0,this.parallelSuccessNumber=0,this.list=[],this.parallelList=[],this.delayNumber=0}start(){this.running||(this.running=!0,this.isComplete=!1,this.run())}pause(){clearTimeout(this.timer),this.timer=null,this.running=!1}resume(){this.start()}skip(){this.index++,this.resume()}stop(){this.isComplete=!0,this.list.forEach(t=>{t.isComplete||t.cancel()}),this.pause(),this.empty()}run(){this.running&&(this.setParallelList(),this.parallelList.length>1?this.runParallelTasks():this.remain?this.runTask():this.onComplete())}runTask(){const t=this.list[this.index];t?t.run().then(()=>{this.onTask(t),this.index++,this.nextTask()}).catch(s=>{this.onError(s)}):this.nextTask()}runParallelTasks(){this.parallelList.forEach(t=>this.runParallelTask(t))}runParallelTask(t){t.run().then(()=>{this.onTask(t),this.fillParallelTask()}).catch(s=>{this.onParallelError(s)})}nextTask(){this.total===this.finishedIndex?this.onComplete():this.timer=setTimeout(()=>this.run())}setParallelList(){let t;this.parallelList=[],this.parallelSuccessNumber=0;let s=this.index+this.config.parallel;s>this.list.length&&(s=this.list.length);for(let r=this.index;r<s&&(t=this.list[r],t.parallel);r++)this.parallelList.push(t)}fillParallelTask(){let t;const s=this.parallelList;this.parallelSuccessNumber++,s.pop();const r=s.length,i=this.finishedIndex+r;if(s.length){if(!this.running)return;i<this.total&&(t=this.list[i],t&&t.parallel&&(s.push(t),this.runParallelTask(t)))}else this.index+=this.parallelSuccessNumber,this.parallelSuccessNumber=0,this.nextTask()}onComplete(){this.stop(),this.config.onComplete&&this.config.onComplete()}onTask(t){t.complete(),this.config.onTask&&this.config.onTask()}onParallelError(t){this.parallelList.forEach(s=>{s.parallel=!1}),this.parallelList.length=0,this.parallelSuccessNumber=0,this.onError(t)}onError(t){this.pause(),this.config.onError&&this.config.onError(t)}destroy(){this.stop()}}const Co=A.get("Resource"),Kt={tasker:new ei,map:{},get isComplete(){return xt.tasker.isComplete},set(e,t){xt.map[e]&&Co.repeat(e),xt.map[e]=t},get:e=>xt.map[e],remove(e){const t=xt.map[e];t&&(t.destroy&&t.destroy(),delete xt.map[e])},loadImage(e,t){return new Promise((s,r)=>{const i=this.setImage(e,e,t);i.load(()=>s(i),n=>r(n))})},setImage(e,t,s){let r;return wt(t)?r={url:t}:t.url||(r={url:e,view:t}),r&&(s&&(r.format=s),t=Re.image(r)),xt.set(e,t),t},destroy(){xt.map={}}},xt=Kt,Oe={maxRecycled:10,recycledList:[],patternTasker:new ei,get(e){let t=Kt.get(e.url);return t||Kt.set(e.url,t=Re.image(e)),t.use++,t},recycle(e){e.use--,setTimeout(()=>{e.use||Jt.recycledList.push(e)})},clearRecycled(){const e=Jt.recycledList;e.length>Jt.maxRecycled&&(e.forEach(t=>!t.use&&t.url&&Kt.remove(t.url)),e.length=0)},hasAlphaPixel:e=>xe.alphaPixelTypes.some(t=>Jt.isFormat(t,e)),isFormat(e,t){if(t.format)return t.format===e;const{url:s}=t;if(s.startsWith("data:")){if(s.startsWith("data:"+xe.mineType(e)))return!0}else if(s.includes("."+e)||s.includes("."+xe.upperCaseTypeMap[e])||e==="png"&&!s.includes("."))return!0;return!1},destroy(){Jt.recycledList=[]}},Jt=Oe,{IMAGE:Oo,create:Po}=dt,{floor:mr,max:xr}=Math;class ih{get url(){return this.config.url}get completed(){return this.ready||!!this.error}constructor(t){if(this.use=0,this.waitComplete=[],this.innerId=Po(Oo),this.config=t||(t={url:""}),t.view){const{view:s}=t;this.setView(s.config?s.view:s)}Oe.isFormat("svg",t)&&(this.isSVG=!0),Oe.hasAlphaPixel(t)&&(this.hasAlphaPixel=!0)}load(t,s){if(!this.loading){this.loading=!0;let{loadImage:r,loadImageWithProgress:i}=J.origin,n=this.config.showProgress&&i&&this.onProgress.bind(this);n&&(r=i),Kt.tasker.add(()=>Gr(this,void 0,void 0,function*(){return yield r(this.url,n).then(o=>this.setView(o)).catch(o=>{this.error=o,this.onComplete(!1)})}))}return this.waitComplete.push(t,s),this.waitComplete.length-2}unload(t,s){const r=this.waitComplete;if(s){const i=r[t+1];i&&i({type:"stop"})}r[t]=r[t+1]=void 0}setView(t){this.ready=!0,this.width=t.naturalWidth||t.width,this.height=t.naturalHeight||t.height,this.view=t,this.onComplete(!0)}onProgress(t){this.progress=t}onComplete(t){let s;this.waitComplete.forEach((r,i)=>{s=i%2,r&&(t?s||r(this):s&&r(this.error))}),this.waitComplete.length=0,this.loading=!1}getFull(t){return this.view}getCanvas(t,s,r,i,n,o,a){if(t||(t=this.width),s||(s=this.height),this.cache){let{params:d,data:h}=this.cache;for(let _ in d)if(d[_]!==arguments[_]){h=null;break}if(h)return h}const l=J.origin.createCanvas(xr(mr(t+(n||0)),1),xr(mr(s+(o||0)),1)),u=l.getContext("2d");return r&&(u.globalAlpha=r),u.imageSmoothingEnabled=a!==!1,u.drawImage(this.view,0,0,t,s),this.cache=this.use>1?{data:l,params:arguments}:null,l}getPattern(t,s,r,i){const n=J.canvas.createPattern(t,s);try{r&&n.setTransform&&(n.setTransform(r),r=void 0)}catch{}return i&&te.stintSet(i,"transform",r),n}destroy(){this.config={url:""},this.cache=null,this.waitComplete.length=0}}function Cs(e,t,s,r){s.configurable=s.enumerable=!0,Object.defineProperty(e,t,s)}function si(e,t){return Object.getOwnPropertyDescriptor(e,t)}function To(e,t){const s="_"+e;return{get(){const r=this[s];return r??t},set(r){this[s]=r}}}function N(e,t){return(s,r)=>So(s,r,e,t&&t(r))}function nh(e){return e}function So(e,t,s,r){Cs(e,t,Object.assign({get(){return this.__getAttr(t)},set(n){this.__setAttr(t,n)}},r||{})),ni(e,t,s)}function oh(e){return N(e)}function ah(e,t){return N(e,s=>({set(r){this.__setAttr(s,r,t)&&(this.__layout.matrixChanged||this.__layout.matrixChange())}}))}function hh(e,t){return N(e,s=>({set(r){this.__setAttr(s,r,t)&&(this.__layout.matrixChanged||this.__layout.matrixChange(),this.__scrollWorld||(this.__scrollWorld={}))}}))}function lh(e){return N(e,t=>({set(s){this.__setAttr(t,s)&&(this.__hasAutoLayout=!!(this.origin||this.around||this.flow),this.__local||this.__layout.createLocal(),jt(this))}}))}function uh(e,t){return N(e,s=>({set(r){this.__setAttr(s,r,t)&&(this.__layout.scaleChanged||this.__layout.scaleChange())}}))}function dh(e,t){return N(e,s=>({set(r){this.__setAttr(s,r,t)&&(this.__layout.rotationChanged||this.__layout.rotationChange())}}))}function ri(e,t){return N(e,s=>({set(r){this.__setAttr(s,r,t)&&jt(this)}}))}function ch(e){return N(e,t=>({set(s){this.__setAttr(t,s)&&(jt(this),this.__.__removeNaturalSize())}}))}function jt(e){e.__layout.boxChanged||e.__layout.boxChange(),e.__hasAutoLayout&&(e.__layout.matrixChanged||e.__layout.matrixChange())}function _h(e){return N(e,t=>({set(s){const r=this.__;r.__pathInputed!==2&&(r.__pathInputed=s?1:0),s||(r.__pathForRender=void 0),this.__setAttr(t,s),jt(this)}}))}const ph=ri;function Ro(e,t){return N(e,s=>({set(r){this.__setAttr(s,r)&&(Lo(this),t&&(this.__.__useStroke=!0))}}))}function Lo(e){e.__layout.strokeChanged||e.__layout.strokeChange(),e.__.__useArrow&&jt(e)}const fh=Ro;function gh(e){return N(e,t=>({set(s){this.__setAttr(t,s),this.__layout.renderChanged||this.__layout.renderChange()}}))}function yh(e){return N(e,t=>({set(s){this.__setAttr(t,s)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange())}}))}function mh(e){return N(e,t=>({set(s){this.__setAttr(t,s)&&(this.__layout.opacityChanged||this.__layout.opacityChange()),this.mask&&ii(this)}}))}function xh(e){return N(e,t=>({set(s){const r=this.visible;if(r===!0&&s===0){if(this.animationOut)return this.__runAnimation("out",()=>wr(this,t,s,r))}else r===0&&s===!0&&this.animation&&this.__runAnimation("in");wr(this,t,s,r),this.mask&&ii(this)}}))}function ii(e){const{parent:t}=e;if(t){const{__hasMask:s}=t;t.__updateMask(),s!==t.__hasMask&&t.forceUpdate()}}function wr(e,t,s,r){e.__setAttr(t,s)&&(e.__layout.opacityChanged||e.__layout.opacityChange(),r!==0&&s!==0||jt(e))}function wh(e){return N(e,t=>({set(s){this.__setAttr(t,s)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange(),this.waitParent(()=>{this.parent.__layout.childrenSortChange()}))}}))}function bh(e){return N(e,t=>({set(s){this.__setAttr(t,s)&&(this.__layout.boxChanged||this.__layout.boxChange(),this.waitParent(()=>{this.parent.__updateMask(s)}))}}))}function Bh(e){return N(e,t=>({set(s){this.__setAttr(t,s)&&this.waitParent(()=>{this.parent.__updateEraser(s)})}}))}function vh(e){return N(e,t=>({set(s){this.__setAttr(t,s)&&(this.__layout.hitCanvasChanged=!0,A.showBounds==="hit"&&(this.__layout.surfaceChanged||this.__layout.surfaceChange()),this.leafer&&this.leafer.updateCursor())}}))}function kh(e){return N(e,t=>({set(s){this.__setAttr(t,s),this.leafer&&this.leafer.updateCursor()}}))}function Ch(e){return(t,s)=>{Cs(t,"__DataProcessor",{get:()=>e})}}function ni(e,t,s){const r=e.__DataProcessor.prototype,i="_"+t,n=function(d){return"set"+d.charAt(0).toUpperCase()+d.slice(1)}(t),o=To(t,s);if(w(s))o.get=function(){return this[i]};else if(typeof s=="function")o.get=function(){const d=this[i];return d??s(this.__leaf)};else if(j(s)){const d=di(s);o.get=function(){const h=this[i];return h??(this[i]=d?{}:te.clone(s))}}const a=e.isBranchLeaf;t==="width"?o.get=function(){const d=this[i];if(d==null){const h=this,_=h.__naturalWidth,c=h.__leaf;return!s||c.pathInputed?c.boxBounds.width:_?h._height&&h.__useNaturalRatio?h._height*_/h.__naturalHeight:_:a&&c.children.length?c.boxBounds.width:s}return d}:t==="height"&&(o.get=function(){const d=this[i];if(d==null){const h=this,_=h.__naturalHeight,c=h.__leaf;return!s||c.pathInputed?c.boxBounds.height:_?h._width&&h.__useNaturalRatio?h._width*_/h.__naturalWidth:_:a&&c.children.length?c.boxBounds.height:s}return d});let l,u=r;for(;!l&&u;)l=si(u,t),u=u.__proto__;l&&l.set&&(o.set=l.set),r[n]&&(o.set=r[n],delete r[n]),Cs(r,t,o)}const Eo=new A("rewrite"),we=[],Io=["destroy","constructor"];function Oh(e){return(t,s)=>{we.push({name:t.constructor.name+"."+s,run:()=>{t[s]=e}})}}function Ph(){return e=>{oi()}}function oi(e){we.length&&(we.forEach(t=>{e&&Eo.error(t.name,"需在Class上装饰@rewriteAble()"),t.run()}),we.length=0)}function zt(e,t){return s=>{var r;(e.prototype?(r=e.prototype,Object.getOwnPropertyNames(r)):Object.keys(e)).forEach(i=>{Io.includes(i)||t&&t.includes(i)||(e.prototype?si(e.prototype,i).writable&&(s.prototype[i]=e.prototype[i]):s.prototype[i]=e[i])})}}function Th(){return e=>{Bs.register(e)}}function Sh(){return e=>{ve.register(e)}}setTimeout(()=>oi(!0));const{copy:Xt,toInnerPoint:Mo,toOuterPoint:Ao,scaleOfOuter:br,rotateOfOuter:Wo,skewOfOuter:No,multiplyParent:Br,divideParent:vr,getLayout:Yo}=b,I={},{round:kr}=Math,Ut={updateAllMatrix(e,t,s){if(t&&e.__hasAutoLayout&&e.__layout.matrixChanged&&(s=!0),Do(e,t,s),e.isBranch){const{children:r}=e;for(let i=0,n=r.length;i<n;i++)Xo(r[i],t,s)}},updateMatrix(e,t,s){const r=e.__layout;t?s&&(r.waitAutoLayout=!0,e.__hasAutoLayout&&(r.matrixChanged=!1)):r.waitAutoLayout&&(r.waitAutoLayout=!1),r.matrixChanged&&e.__updateLocalMatrix(),r.waitAutoLayout||e.__updateWorldMatrix()},updateBounds(e){const t=e.__layout;t.boundsChanged&&e.__updateLocalBounds(),t.waitAutoLayout||e.__updateWorldBounds()},updateAllWorldOpacity(e){if(e.__updateWorldOpacity(),e.isBranch){const{children:t}=e;for(let s=0,r=t.length;s<r;s++)Cr(t[s])}},updateChange(e){const t=e.__layout;t.stateStyleChanged&&e.updateState(),t.opacityChanged&&Cr(e),e.__updateChange()},updateAllChange(e){if(Fo(e),e.isBranch){const{children:t}=e;for(let s=0,r=t.length;s<r;s++)zo(t[s])}},worldHittable(e){for(;e;){if(!e.__.hittable)return!1;e=e.parent}return!0},draggable:e=>(e.draggable||e.editable)&&e.hitSelf&&!e.locked,copyCanvasByWorld(e,t,s,r,i,n){r||(r=e.__nowWorld),e.__worldFlipped||J.fullImageShadow?t.copyWorldByReset(s,r,e.__nowWorld,i,n):t.copyWorldToInner(s,r,e.__layout.renderBounds,i)},moveWorld(e,t,s=0,r,i){const n=j(t)?Object.assign({},t):{x:t,y:s};r?Ao(e.localTransform,n,n,!0):e.parent&&Mo(e.parent.scrollWorldTransform,n,n,!0),M.moveLocal(e,n.x,n.y,i)},moveLocal(e,t,s=0,r){j(t)&&(s=t.y,t=t.x),t+=e.x,s+=e.y,e.leafer&&e.leafer.config.pointSnap&&(t=kr(t),s=kr(s)),r?e.animate({x:t,y:s},r):(e.x=t,e.y=s)},zoomOfWorld(e,t,s,r,i,n){M.zoomOfLocal(e,ts(e,t),s,r,i,n)},zoomOfLocal(e,t,s,r=s,i,n){const o=e.__localMatrix;if(Ft(r)||(r&&(n=r),r=s),Xt(I,o),br(I,t,s,r),M.hasHighPosition(e))M.setTransform(e,I,i,n);else{const a=e.x+I.e-o.e,l=e.y+I.f-o.f;n&&!i?e.animate({x:a,y:l,scaleX:e.scaleX*s,scaleY:e.scaleY*r},n):(e.x=a,e.y=l,e.scaleResize(s,r,i!==!0))}},rotateOfWorld(e,t,s,r){M.rotateOfLocal(e,ts(e,t),s,r)},rotateOfLocal(e,t,s,r){const i=e.__localMatrix;Xt(I,i),Wo(I,t,s),M.hasHighPosition(e)?M.setTransform(e,I,!1,r):e.set({x:e.x+I.e-i.e,y:e.y+I.f-i.f,rotation:ct.formatRotation(e.rotation+s)},r)},skewOfWorld(e,t,s,r,i,n){M.skewOfLocal(e,ts(e,t),s,r,i,n)},skewOfLocal(e,t,s,r=0,i,n){Xt(I,e.__localMatrix),No(I,t,s,r),M.setTransform(e,I,i,n)},transformWorld(e,t,s,r){Xt(I,e.worldTransform),Br(I,t),e.parent&&vr(I,e.parent.scrollWorldTransform),M.setTransform(e,I,s,r)},transform(e,t,s,r){Xt(I,e.localTransform),Br(I,t),M.setTransform(e,I,s,r)},setTransform(e,t,s,r){const i=e.__,n=i.origin&&M.getInnerOrigin(e,i.origin),o=Yo(t,n,i.around&&M.getInnerOrigin(e,i.around));if(M.hasOffset(e)&&(o.x-=i.offsetX,o.y-=i.offsetY),s){const a=o.scaleX/e.scaleX,l=o.scaleY/e.scaleY;if(delete o.scaleX,delete o.scaleY,n){m.scale(e.boxBounds,Math.abs(a),Math.abs(l));const u=M.getInnerOrigin(e,i.origin);S.move(o,n.x-u.x,n.y-u.y)}e.set(o),e.scaleResize(a,l,!1)}else e.set(o,r)},getFlipTransform(e,t){const s={a:1,b:0,c:0,d:1,e:0,f:0},r=t==="x"?1:-1;return br(s,M.getLocalOrigin(e,"center"),-1*r,1*r),s},getLocalOrigin:(e,t)=>S.tempToOuterOf(M.getInnerOrigin(e,t),e.localTransform),getInnerOrigin(e,t){const s={};return Se.toPoint(t,e.boxBounds,s),s},getRelativeWorld:(e,t,s)=>(Xt(I,e.worldTransform),vr(I,t.scrollWorldTransform),s?I:Object.assign({},I)),drop(e,t,s,r){e.setTransform(M.getRelativeWorld(e,t,!0),r),t.add(e,s)},hasHighPosition:e=>e.origin||e.around||M.hasOffset(e),hasOffset:e=>e.offsetX||e.offsetY,hasParent(e,t){if(!t)return!1;for(;e;){if(t===e)return!0;e=e.parent}},animateMove(e,t,s=.3){if(t.x||t.y)if(Math.abs(t.x)<1&&Math.abs(t.y)<1)e.move(t);else{const r=t.x*s,i=t.y*s;t.x-=r,t.y-=i,e.move(r,i),J.requestRender(()=>M.animateMove(e,t,s))}}},M=Ut,{updateAllMatrix:Xo,updateMatrix:Do,updateAllWorldOpacity:Cr,updateAllChange:zo,updateChange:Fo}=M;function ts(e,t){return e.updateLayout(),e.parent?S.tempToInnerOf(t,e.parent.scrollWorldTransform):t}const ai={worldBounds:e=>e.__world,localBoxBounds:e=>e.__.eraser||e.__.visible===0?null:e.__local||e.__layout,localStrokeBounds:e=>e.__.eraser||e.__.visible===0?null:e.__layout.localStrokeBounds,localRenderBounds:e=>e.__.eraser||e.__.visible===0?null:e.__layout.localRenderBounds,maskLocalBoxBounds:(e,t)=>es(e,t)&&e.__localBoxBounds,maskLocalStrokeBounds:(e,t)=>es(e,t)&&e.__layout.localStrokeBounds,maskLocalRenderBounds:(e,t)=>es(e,t)&&e.__layout.localRenderBounds,excludeRenderBounds:(e,t)=>!(!t.bounds||t.bounds.hit(e.__world,t.matrix))||!(!t.hideBounds||!t.hideBounds.includes(e.__world,t.matrix))};let Zt;function es(e,t){return t||(Zt=0),e.__.mask&&(Zt=1),Zt<0?null:(Zt&&(Zt=-1),!0)}const{updateBounds:Or}=Ut,Os={sort:(e,t)=>e.__.zIndex===t.__.zIndex?e.__tempNumber-t.__tempNumber:e.__.zIndex-t.__.zIndex,pushAllChildBranch(e,t){if(e.__tempNumber=1,e.__.__childBranchNumber){const{children:s}=e;for(let r=0,i=s.length;r<i;r++)(e=s[r]).isBranch&&(e.__tempNumber=1,t.add(e),jo(e,t))}},pushAllParent(e,t){const{keys:s}=t;if(s)for(;e.parent&&w(s[e.parent.innerId]);)t.add(e.parent),e=e.parent;else for(;e.parent;)t.add(e.parent),e=e.parent},pushAllBranchStack(e,t){let s=t.length;const{children:r}=e;for(let i=0,n=r.length;i<n;i++)r[i].isBranch&&t.push(r[i]);for(let i=s,n=t.length;i<n;i++)Pr(t[i],t)},updateBounds(e,t){const s=[e];Pr(e,s),Uo(s,t)},updateBoundsByBranchStack(e,t){let s,r;for(let i=e.length-1;i>-1;i--){s=e[i],r=s.children;for(let n=0,o=r.length;n<o;n++)Or(r[n]);t&&t===s||Or(s)}}},{pushAllChildBranch:jo,pushAllBranchStack:Pr,updateBoundsByBranchStack:Uo}=Os,Rh={run(e){if(e&&e.length){const t=e.length;for(let s=0;s<t;s++)e[s]();e.length===t?e.length=0:e.splice(0,t)}}},{getRelativeWorld:Tr,updateBounds:Ho}=Ut,{toOuterOf:ye,getPoints:Go,copy:Vo}=m,ss="_localContentBounds",rs="_worldContentBounds",is="_worldBoxBounds",ns="_worldStrokeBounds";class qo{get contentBounds(){return this._contentBounds||this.boxBounds}set contentBounds(t){this._contentBounds=t}get strokeBounds(){return this._strokeBounds||this.boxBounds}get renderBounds(){return this._renderBounds||this.boxBounds}set renderBounds(t){this._renderBounds=t}get localContentBounds(){return ye(this.contentBounds,this.leaf.__localMatrix,this[ss]||(this[ss]={})),this[ss]}get localStrokeBounds(){return this._localStrokeBounds||this}get localRenderBounds(){return this._localRenderBounds||this}get worldContentBounds(){return ye(this.contentBounds,this.leaf.__world,this[rs]||(this[rs]={})),this[rs]}get worldBoxBounds(){return ye(this.boxBounds,this.leaf.__world,this[is]||(this[is]={})),this[is]}get worldStrokeBounds(){return ye(this.strokeBounds,this.leaf.__world,this[ns]||(this[ns]={})),this[ns]}get a(){return 1}get b(){return 0}get c(){return 0}get d(){return 1}get e(){return this.leaf.__.x}get f(){return this.leaf.__.y}get x(){return this.e+this.boxBounds.x}get y(){return this.f+this.boxBounds.y}get width(){return this.boxBounds.width}get height(){return this.boxBounds.height}constructor(t){this.leaf=t,this.leaf.__local&&(this._localRenderBounds=this._localStrokeBounds=this.leaf.__local),t.__world&&(this.boxBounds={x:0,y:0,width:0,height:0},this.boxChange(),this.matrixChange())}createLocal(){const t=this.leaf.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0};this._localStrokeBounds||(this._localStrokeBounds=t),this._localRenderBounds||(this._localRenderBounds=t)}update(){const{leaf:t}=this,{leafer:s}=t;if(t.isApp)return Ho(t);if(s)s.ready?s.watcher.changed&&s.layouter.layout():s.start();else{let r=t;for(;r.parent&&!r.parent.leafer;)r=r.parent;const i=r;if(i.__fullLayouting)return;i.__fullLayouting=!0,J.layout(i),delete i.__fullLayouting}}getTransform(t="world"){this.update();const{leaf:s}=this;switch(t){case"world":return s.__world;case"local":return s.__localMatrix;case"inner":return b.defaultMatrix;case"page":t=s.zoomLayer;default:return Tr(s,t)}}getBounds(t,s="world"){switch(this.update(),s){case"world":return this.getWorldBounds(t);case"local":return this.getLocalBounds(t);case"inner":return this.getInnerBounds(t);case"page":s=this.leaf.zoomLayer;default:return new _t(this.getInnerBounds(t)).toOuterOf(this.getTransform(s))}}getInnerBounds(t="box"){switch(t){case"render":return this.renderBounds;case"content":if(this.contentBounds)return this.contentBounds;case"box":return this.boxBounds;case"stroke":return this.strokeBounds}}getLocalBounds(t="box"){switch(t){case"render":return this.localRenderBounds;case"stroke":return this.localStrokeBounds;case"content":if(this.contentBounds)return this.localContentBounds;case"box":return this.leaf.__localBoxBounds}}getWorldBounds(t="box"){switch(t){case"render":return this.leaf.__world;case"stroke":return this.worldStrokeBounds;case"content":if(this.contentBounds)return this.worldContentBounds;case"box":return this.worldBoxBounds}}getLayoutBounds(t,s="world",r){const{leaf:i}=this;let n,o,a,l=this.getInnerBounds(t);switch(s){case"world":n=i.getWorldPoint(l),o=i.__world;break;case"local":const{scaleX:u,scaleY:d,rotation:h,skewX:_,skewY:c}=i.__;a={scaleX:u,scaleY:d,rotation:h,skewX:_,skewY:c},n=i.getLocalPointByInner(l);break;case"inner":n=l,o=b.defaultMatrix;break;case"page":s=i.zoomLayer;default:n=i.getWorldPoint(l,s),o=Tr(i,s,!0)}if(a||(a=b.getLayout(o)),Vo(a,l),S.copy(a,n),r){const{scaleX:u,scaleY:d}=a,h=Math.abs(u),_=Math.abs(d);h===1&&_===1||(a.scaleX/=h,a.scaleY/=_,a.width*=h,a.height*=_)}return a}getLayoutPoints(t,s="world"){const{leaf:r}=this,i=Go(this.getInnerBounds(t));let n;switch(s){case"world":n=null;break;case"local":n=r.parent;break;case"inner":break;case"page":s=r.zoomLayer;default:n=s}return w(n)||i.forEach(o=>r.innerToWorld(o,null,!1,n)),i}shrinkContent(){const{x:t,y:s,width:r,height:i}=this.boxBounds;this._contentBounds={x:t,y:s,width:r,height:i}}spreadStroke(){const{x:t,y:s,width:r,height:i}=this.strokeBounds;this._strokeBounds={x:t,y:s,width:r,height:i},this._localStrokeBounds={x:t,y:s,width:r,height:i},this.renderSpread||this.spreadRenderCancel()}spreadRender(){const{x:t,y:s,width:r,height:i}=this.renderBounds;this._renderBounds={x:t,y:s,width:r,height:i},this._localRenderBounds={x:t,y:s,width:r,height:i}}shrinkContentCancel(){this._contentBounds=void 0}spreadStrokeCancel(){const t=this.renderBounds===this.strokeBounds;this._strokeBounds=this.boxBounds,this._localStrokeBounds=this.leaf.__localBoxBounds,t&&this.spreadRenderCancel()}spreadRenderCancel(){this._renderBounds=this._strokeBounds,this._localRenderBounds=this._localStrokeBounds}boxChange(){this.boxChanged=!0,this.localBoxChanged?this.boundsChanged||(this.boundsChanged=!0):this.localBoxChange(),this.hitCanvasChanged=!0}localBoxChange(){this.localBoxChanged=!0,this.boundsChanged=!0}strokeChange(){this.strokeChanged=!0,this.strokeSpread||(this.strokeSpread=1),this.boundsChanged=!0,this.hitCanvasChanged=!0}renderChange(){this.renderChanged=!0,this.renderSpread||(this.renderSpread=1),this.boundsChanged=!0}scaleChange(){this.scaleChanged=!0,this._scaleOrRotationChange()}rotationChange(){this.rotationChanged=!0,this.affectRotation=!0,this._scaleOrRotationChange()}_scaleOrRotationChange(){this.affectScaleOrRotation=!0,this.matrixChange(),this.leaf.__local||this.createLocal()}matrixChange(){this.matrixChanged=!0,this.localBoxChanged?this.boundsChanged||(this.boundsChanged=!0):this.localBoxChange()}surfaceChange(){this.surfaceChanged=!0}opacityChange(){this.opacityChanged=!0,this.surfaceChanged||this.surfaceChange()}childrenSortChange(){this.childrenSortChanged||(this.childrenSortChanged=this.affectChildrenSort=!0,this.leaf.forceUpdate("surface"))}destroy(){}}class pt{constructor(t,s){this.bubbles=!1,this.type=t,s&&(this.target=s)}stopDefault(){this.isStopDefault=!0,this.origin&&J.event.stopDefault(this.origin)}stopNow(){this.isStopNow=!0,this.isStop=!0,this.origin&&J.event.stopNow(this.origin)}stop(){this.isStop=!0,this.origin&&J.event.stop(this.origin)}}class X extends pt{constructor(t,s,r){super(t,s),this.parent=r,this.child=s}}X.ADD="child.add",X.REMOVE="child.remove",X.CREATED="created",X.MOUNTED="mounted",X.UNMOUNTED="unmounted",X.DESTROY="destroy";const ps="property.scroll";class St extends pt{constructor(t,s,r,i,n){super(t,s),this.attrName=r,this.oldValue=i,this.newValue=n}}St.CHANGE="property.change",St.LEAFER_CHANGE="property.leafer_change",St.SCROLL=ps;const Qo={scrollX:ps,scrollY:ps};class os extends pt{constructor(t,s){super(t),Object.assign(this,s)}}os.LOAD="image.load",os.LOADED="image.loaded",os.ERROR="image.error";class ut extends pt{static checkHas(t,s,r){r==="on"?s===be?t.__hasWorldEvent=!0:t.__hasLocalEvent=!0:(t.__hasLocalEvent=t.hasEvent(fs)||t.hasEvent(gs)||t.hasEvent(ys),t.__hasWorldEvent=t.hasEvent(be))}static emitLocal(t){if(t.leaferIsReady){const{resized:s}=t.__layout;s!=="local"&&(t.emit(fs,t),s==="inner"&&t.emit(gs,t)),t.emit(ys,t)}}static emitWorld(t){t.leaferIsReady&&t.emit(be,this)}}ut.RESIZE="bounds.resize",ut.INNER="bounds.inner",ut.LOCAL="bounds.local",ut.WORLD="bounds.world";const{RESIZE:fs,INNER:gs,LOCAL:ys,WORLD:be}=ut,ms={};[fs,gs,ys,be].forEach(e=>ms[e]=1);class Ps extends pt{get bigger(){if(!this.old)return!0;const{width:t,height:s}=this.old;return this.width>=t&&this.height>=s}get smaller(){return!this.bigger}get samePixelRatio(){return!this.old||this.pixelRatio===this.old.pixelRatio}constructor(t,s){j(t)?(super(Ps.RESIZE),Object.assign(this,t)):super(t),this.old=s}static isResizing(t){return this.resizingKeys&&!w(this.resizingKeys[t.innerId])}}Ps.RESIZE="resize";class Sr extends pt{constructor(t,s){super(t),this.data=s}}Sr.REQUEST="watch.request",Sr.DATA="watch.data";class Pt extends pt{constructor(t,s,r){super(t),s&&(this.data=s,this.times=r)}}Pt.REQUEST="layout.request",Pt.START="layout.start",Pt.BEFORE="layout.before",Pt.LAYOUT="layout",Pt.AFTER="layout.after",Pt.AGAIN="layout.again",Pt.END="layout.end";class st extends pt{constructor(t,s,r,i){super(t),s&&(this.times=s),r&&(this.renderBounds=r,this.renderOptions=i)}}st.REQUEST="render.request",st.CHILD_START="render.child_start",st.CHILD_END="render.child_end",st.START="render.start",st.BEFORE="render.before",st.RENDER="render",st.AFTER="render.after",st.AGAIN="render.again",st.END="render.end",st.NEXT="render.next";class Y extends pt{}Y.START="leafer.start",Y.BEFORE_READY="leafer.before_ready",Y.READY="leafer.ready",Y.AFTER_READY="leafer.after_ready",Y.VIEW_READY="leafer.view_ready",Y.VIEW_COMPLETED="leafer.view_completed",Y.STOP="leafer.stop",Y.RESTART="leafer.restart",Y.END="leafer.end",Y.TRANSFORM="leafer.transform",Y.MOVE="leafer.move",Y.SCALE="leafer.scale",Y.ROTATE="leafer.rotate",Y.SKEW="leafer.skew";const{MOVE:Rr,SCALE:Lr,ROTATE:Jo,SKEW:Er}=Y,Zo={x:Rr,y:Rr,scaleX:Lr,scaleY:Lr,rotation:Jo,skewX:Er,skewY:Er},Ir={};class $o{set event(t){this.on(t)}on(t,s,r){if(!s){let d;if(Q(t))t.forEach(h=>this.on(h[0],h[1],h[2]));else for(let h in t)Q(d=t[h])?this.on(h,d[0],d[1]):this.on(h,d);return}let i,n,o;r&&(r==="once"?n=!0:typeof r=="boolean"?i=r:(i=r.capture,n=r.once));const a=as(this,i,!0),l=wt(t)?t.split(" "):t,u=n?{listener:s,once:n}:{listener:s};l.forEach(d=>{d&&(o=a[d],o?o.findIndex(h=>h.listener===s)===-1&&o.push(u):a[d]=[u],ms[d]&&ut.checkHas(this,d,"on"))})}off(t,s,r){if(t){const i=wt(t)?t.split(" "):t;if(s){let n,o,a;r&&(n=typeof r=="boolean"?r:r!=="once"&&r.capture);const l=as(this,n);i.forEach(u=>{u&&(o=l[u],o&&(a=o.findIndex(d=>d.listener===s),a>-1&&o.splice(a,1),o.length||delete l[u],ms[u]&&ut.checkHas(this,u,"off")))})}else{const{__bubbleMap:n,__captureMap:o}=this;i.forEach(a=>{n&&delete n[a],o&&delete o[a]})}}else this.__bubbleMap=this.__captureMap=void 0}on_(t,s,r,i){return s?this.on(t,r?s=s.bind(r):s,i):Q(t)&&t.forEach(n=>this.on(n[0],n[2]?n[1]=n[1].bind(n[2]):n[1],n[3])),{type:t,current:this,listener:s,options:i}}off_(t){if(!t)return;const s=Q(t)?t:[t];s.forEach(r=>{r&&(r.listener?r.current.off(r.type,r.listener,r.options):Q(r.type)&&r.type.forEach(i=>r.current.off(i[0],i[1],i[3])))}),s.length=0}once(t,s,r,i){if(!s)return Q(t)&&t.forEach(n=>this.once(n[0],n[1],n[2],n[3]));j(r)?s=s.bind(r):i=r,this.on(t,s,{once:!0,capture:i})}emit(t,s,r){!s&&ve.has(t)&&(s=ve.get(t,{type:t,target:this,current:this}));const i=as(this,r)[t];if(i){let n;for(let o=0,a=i.length;o<a&&!((n=i[o])&&(n.listener(s),n.once&&(this.off(t,n.listener,r),o--,a--),s&&s.isStopNow));o++);}this.syncEventer&&this.syncEventer.emitEvent(s,r)}emitEvent(t,s){t.current=this,this.emit(t.type,t,s)}hasEvent(t,s){if(this.syncEventer&&this.syncEventer.hasEvent(t,s))return!0;const{__bubbleMap:r,__captureMap:i}=this,n=r&&r[t],o=i&&i[t];return!!(w(s)?n||o:s?o:n)}destroy(){this.__captureMap=this.__bubbleMap=this.syncEventer=null}}function as(e,t,s){if(t){const{__captureMap:r}=e;return r||(s?e.__captureMap={}:Ir)}{const{__bubbleMap:r}=e;return r||(s?e.__bubbleMap={}:Ir)}}const{on:Ko,on_:ta,off:ea,off_:sa,once:ra,emit:ia,emitEvent:na,hasEvent:oa,destroy:aa}=$o.prototype,ha={on:Ko,on_:ta,off:ea,off_:sa,once:ra,emit:ia,emitEvent:na,hasEvent:oa,destroyEventer:aa},la=A.get("setAttr"),ua={__setAttr(e,t,s){if(this.leaferIsCreated){const r=this.__.__getInput(e);if(!s||ui(t)||w(t)||(la.warn(this.innerName,e,t),t=void 0),j(t)||r!==t){if(this.__realSetAttr(e,t),this.isLeafer){this.emitEvent(new St(St.LEAFER_CHANGE,this,e,r,t));const n=Zo[e];n&&(this.emitEvent(new Y(n,this)),this.emitEvent(new Y(Y.TRANSFORM,this)))}this.emitPropertyEvent(St.CHANGE,e,r,t);const i=Qo[e];return i&&this.emitPropertyEvent(i,e,r,t),!0}return!1}return this.__realSetAttr(e,t),!0},emitPropertyEvent(e,t,s,r){const i=new St(e,this,t,s,r);this.isLeafer||this.hasEvent(e)&&this.emitEvent(i),this.leafer.emitEvent(i)},__realSetAttr(e,t){const s=this.__;s[e]=t,this.__proxyData&&this.setProxyAttr(e,t),s.normalStyle&&(this.lockNormalStyle||w(s.normalStyle[e])||(s.normalStyle[e]=t))},__getAttr(e){return this.__proxyData?this.getProxyAttr(e):this.__.__get(e)}},{setLayout:da,multiplyParent:ca,translateInner:Mr,defaultWorld:_a}=b,{toPoint:pa,tempPoint:hs}=Se,fa={__updateWorldMatrix(){const{parent:e,__layout:t,__world:s,__scrollWorld:r,__:i}=this;ca(this.__local||t,e?e.__scrollWorld||e.__world:_a,s,!!t.affectScaleOrRotation,i),r&&Mr(Object.assign(r,s),i.scrollX,i.scrollY)},__updateLocalMatrix(){if(this.__local){const e=this.__layout,t=this.__local,s=this.__;e.affectScaleOrRotation&&(e.scaleChanged&&(e.resized||(e.resized="scale"))||e.rotationChanged)&&(da(t,s,null,null,e.affectRotation),e.scaleChanged=e.rotationChanged=void 0),t.e=s.x+s.offsetX,t.f=s.y+s.offsetY,(s.around||s.origin)&&(pa(s.around||s.origin,e.boxBounds,hs),Mr(t,-hs.x,-hs.y,!s.around))}this.__layout.matrixChanged=void 0}},{updateMatrix:ga,updateAllMatrix:Ar}=Ut,{updateBounds:Wr}=Os,{toOuterOf:me,copyAndSpread:Nr,copy:ya}=m,{toBounds:ma}=Kr,xa={__updateWorldBounds(){const e=this.__layout;me(e.renderBounds,this.__world,this.__world),e.resized&&(e.resized==="inner"&&this.__onUpdateSize(),this.__hasLocalEvent&&ut.emitLocal(this),e.resized=void 0),this.__hasWorldEvent&&ut.emitWorld(this)},__updateLocalBounds(){const e=this.__layout;e.boxChanged&&(this.__.__pathInputed||this.__updatePath(),this.__updateRenderPath(),this.__updateBoxBounds(),e.resized="inner"),e.localBoxChanged&&(this.__local&&this.__updateLocalBoxBounds(),e.localBoxChanged=void 0,e.strokeSpread&&(e.strokeChanged=!0),e.renderSpread&&(e.renderChanged=!0),this.parent&&this.parent.__layout.boxChange()),e.boxChanged=void 0,e.strokeChanged&&(e.strokeSpread=this.__updateStrokeSpread(),e.strokeSpread?(e.strokeBounds===e.boxBounds&&e.spreadStroke(),this.__updateStrokeBounds(),this.__updateLocalStrokeBounds()):e.spreadStrokeCancel(),e.strokeChanged=void 0,(e.renderSpread||e.strokeSpread!==e.strokeBoxSpread)&&(e.renderChanged=!0),this.parent&&this.parent.__layout.strokeChange(),e.resized="inner"),e.renderChanged&&(e.renderSpread=this.__updateRenderSpread(),e.renderSpread?(e.renderBounds!==e.boxBounds&&e.renderBounds!==e.strokeBounds||e.spreadRender(),this.__updateRenderBounds(),this.__updateLocalRenderBounds()):e.spreadRenderCancel(),e.renderChanged=void 0,this.parent&&this.parent.__layout.renderChange()),e.resized||(e.resized="local"),e.boundsChanged=void 0},__updateLocalBoxBounds(){this.__hasMotionPath&&this.__updateMotionPath(),this.__hasAutoLayout&&this.__updateAutoLayout(),me(this.__layout.boxBounds,this.__local,this.__local)},__updateLocalStrokeBounds(){me(this.__layout.strokeBounds,this.__localMatrix,this.__layout.localStrokeBounds)},__updateLocalRenderBounds(){me(this.__layout.renderBounds,this.__localMatrix,this.__layout.localRenderBounds)},__updateBoxBounds(e,t){const s=this.__layout.boxBounds,r=this.__;r.__usePathBox?ma(r.path,s):(s.x=0,s.y=0,s.width=r.width,s.height=r.height)},__updateAutoLayout(){this.__layout.matrixChanged=!0,this.isBranch?(this.__extraUpdate(),this.__.flow?(this.__layout.boxChanged&&this.__updateFlowLayout(),Ar(this),Wr(this,this),this.__.__autoSide&&this.__updateBoxBounds(!0)):(Ar(this),Wr(this,this))):ga(this)},__updateNaturalSize(){const{__:e,__layout:t}=this;e.__naturalWidth=t.boxBounds.width,e.__naturalHeight=t.boxBounds.height},__updateStrokeBounds(e){const t=this.__layout;Nr(t.strokeBounds,t.boxBounds,t.strokeBoxSpread)},__updateRenderBounds(e){const t=this.__layout;t.renderSpread>0?Nr(t.renderBounds,t.boxBounds,t.renderSpread):ya(t.renderBounds,t.strokeBounds)}},wa={__render(e,t){if(t.shape)return this.__renderShape(e,t);if(this.__worldOpacity){const s=this.__;if(e.setWorld(this.__nowWorld=this.__getNowWorld(t)),e.opacity=t.dimOpacity&&!s.dimskip?s.opacity*t.dimOpacity:s.opacity,this.__.__single){if(s.eraser==="path")return this.__renderEraser(e,t);const r=e.getSameCanvas(!0,!0);this.__draw(r,t,e),Ut.copyCanvasByWorld(this,e,r,this.__nowWorld,s.__blendMode,!0),r.recycle(this.__nowWorld)}else this.__draw(e,t);A.showBounds&&A.drawBounds(this,e,t)}},__renderShape(e,t){this.__worldOpacity&&(e.setWorld(this.__nowWorld=this.__getNowWorld(t)),this.__drawShape(e,t))},__clip(e,t){this.__worldOpacity&&(e.setWorld(this.__nowWorld=this.__getNowWorld(t)),this.__drawRenderPath(e),e.clipUI(this))},__updateWorldOpacity(){this.__worldOpacity=this.__.visible?this.parent?this.parent.__worldOpacity*this.__.opacity:this.__.opacity:0,this.__layout.opacityChanged&&(this.__layout.opacityChanged=!1)}},{excludeRenderBounds:Yr}=ai,ba={__updateChange(){const{__layout:e}=this;e.childrenSortChanged&&(this.__updateSortChildren(),e.childrenSortChanged=!1),this.__.__checkSingle()},__render(e,t){if(this.__nowWorld=this.__getNowWorld(t),this.__worldOpacity){const s=this.__;if(s.dim?t.dimOpacity=s.dim===!0?.2:s.dim:s.dimskip&&t.dimOpacity&&(t.dimOpacity=0),s.__single&&!this.isBranchLeaf){if(s.eraser==="path")return this.__renderEraser(e,t);const r=e.getSameCanvas(!1,!0);this.__renderBranch(r,t);const i=this.__nowWorld;e.opacity=t.dimOpacity?s.opacity*t.dimOpacity:s.opacity,e.copyWorldByReset(r,i,i,s.__blendMode,!0),r.recycle(i)}else this.__renderBranch(e,t)}},__renderBranch(e,t){if(this.__hasMask)this.__renderMask(e,t);else{const{children:s}=this;for(let r=0,i=s.length;r<i;r++)Yr(s[r],t)||s[r].__render(e,t)}},__clip(e,t){if(this.__worldOpacity){const{children:s}=this;for(let r=0,i=s.length;r<i;r++)Yr(s[r],t)||s[r].__clip(e,t)}}},ls={},{LEAF:Ba,create:va}=dt,{toInnerPoint:ka,toOuterPoint:Ca,multiplyParent:Oa}=b,{toOuterOf:Xr}=m,{copy:Dr,move:zr}=S,{moveLocal:Pa,zoomOfLocal:Ta,rotateOfLocal:Sa,skewOfLocal:Ra,moveWorld:Fr,zoomOfWorld:La,rotateOfWorld:Ea,skewOfWorld:Ia,transform:jr,transformWorld:Ma,setTransform:Aa,getFlipTransform:Wa,getLocalOrigin:us,getRelativeWorld:Na,drop:Ya}=Ut;let xs=class{get tag(){return this.__tag}set tag(e){}get __tag(){return"Leaf"}get innerName(){return this.__.name||this.tag+this.innerId}get __DataProcessor(){return ci}get __LayoutProcessor(){return qo}get leaferIsCreated(){return this.leafer&&this.leafer.created}get leaferIsReady(){return this.leafer&&this.leafer.ready}get isLeafer(){return!1}get isBranch(){return!1}get isBranchLeaf(){return!1}get __localMatrix(){return this.__local||this.__layout}get __localBoxBounds(){return this.__local||this.__layout}get worldTransform(){return this.__layout.getTransform("world")}get localTransform(){return this.__layout.getTransform("local")}get scrollWorldTransform(){return this.updateLayout(),this.__scrollWorld||this.__world}get boxBounds(){return this.getBounds("box","inner")}get renderBounds(){return this.getBounds("render","inner")}get worldBoxBounds(){return this.getBounds("box")}get worldStrokeBounds(){return this.getBounds("stroke")}get worldRenderBounds(){return this.getBounds("render")}get worldOpacity(){return this.updateLayout(),this.__worldOpacity}get __worldFlipped(){return this.__world.scaleX<0||this.__world.scaleY<0}get __onlyHitMask(){return this.__hasMask&&!this.__.hitChildren}get __ignoreHitWorld(){return(this.__hasMask||this.__hasEraser)&&this.__.hitChildren}get __inLazyBounds(){return this.leaferIsCreated&&this.leafer.lazyBounds.hit(this.__world)}get pathInputed(){return this.__.__pathInputed}set event(e){this.on(e)}constructor(e){this.innerId=va(Ba),this.reset(e),this.__bubbleMap&&this.__emitLifeEvent(X.CREATED)}reset(e){this.leafer&&this.leafer.forceRender(this.__world),e!==0&&(this.__world={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0,scaleX:1,scaleY:1},e!==null&&(this.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0})),this.__worldOpacity=1,this.__=new this.__DataProcessor(this),this.__layout=new this.__LayoutProcessor(this),this.__level&&this.resetCustom(),e&&(e.__&&(e=e.toJSON()),e.children?this.set(e):Object.assign(this,e))}resetCustom(){this.__hasMask=this.__hasEraser=null,this.forceUpdate()}waitParent(e,t){t&&(e=e.bind(t)),this.parent?e():this.on(X.ADD,e,"once")}waitLeafer(e,t){t&&(e=e.bind(t)),this.leafer?e():this.on(X.MOUNTED,e,"once")}nextRender(e,t,s){this.leafer?this.leafer.nextRender(e,t,s):this.waitLeafer(()=>this.leafer.nextRender(e,t,s))}removeNextRender(e){this.nextRender(e,null,"off")}__bindLeafer(e){if(this.isLeafer&&e!==null&&(e=this),this.leafer&&!e&&this.leafer.leafs--,this.leafer=e,e?(e.leafs++,this.__level=this.parent?this.parent.__level+1:1,this.animation&&this.__runAnimation("in"),this.__bubbleMap&&this.__emitLifeEvent(X.MOUNTED)):this.__emitLifeEvent(X.UNMOUNTED),this.isBranch){const{children:t}=this;for(let s=0,r=t.length;s<r;s++)t[s].__bindLeafer(e)}}set(e,t){}get(e){}setAttr(e,t){this[e]=t}getAttr(e){return this[e]}getComputedAttr(e){return this.__[e]}toJSON(e){return e&&this.__layout.update(),this.__.__getInputData(null,e)}toString(e){return JSON.stringify(this.toJSON(e))}toSVG(){}__SVG(e){}toHTML(){}__setAttr(e,t){return!0}__getAttr(e){}setProxyAttr(e,t){}getProxyAttr(e){}find(e,t){}findTag(e){}findOne(e,t){}findId(e){}focus(e){}updateState(){}updateLayout(){this.__layout.update()}forceUpdate(e){w(e)?e="width":e==="surface"&&(e="blendMode");const t=this.__.__getInput(e);this.__[e]=w(t)?null:void 0,this[e]=t}forceRender(e,t){this.forceUpdate("surface")}__extraUpdate(){this.leaferIsReady&&this.leafer.layouter.addExtra(this)}__updateWorldMatrix(){}__updateLocalMatrix(){}__updateWorldBounds(){}__updateLocalBounds(){}__updateLocalBoxBounds(){}__updateLocalStrokeBounds(){}__updateLocalRenderBounds(){}__updateBoxBounds(e,t){}__updateContentBounds(){}__updateStrokeBounds(e){}__updateRenderBounds(e){}__updateAutoLayout(){}__updateFlowLayout(){}__updateNaturalSize(){}__updateStrokeSpread(){return 0}__updateRenderSpread(){return 0}__onUpdateSize(){}__updateEraser(e){this.__hasEraser=!!e||this.children.some(t=>t.__.eraser)}__renderEraser(e,t){e.save(),this.__clip(e,t);const{renderBounds:s}=this.__layout;e.clearRect(s.x,s.y,s.width,s.height),e.restore()}__updateMask(e){this.__hasMask=this.children.some(t=>t.__.mask&&t.__.visible&&t.__.opacity)}__renderMask(e,t){}__getNowWorld(e){if(e.matrix){this.__cameraWorld||(this.__cameraWorld={});const t=this.__cameraWorld,s=this.__world;return Oa(s,e.matrix,t,void 0,s),Xr(this.__layout.renderBounds,t,t),t.half!==s.half&&(t.half=s.half),t}return this.__world}getClampRenderScale(){let{scaleX:e}=this.__nowWorld||this.__world;return e<0&&(e=-e),e>1?e:1}getRenderScaleData(e,t){let{scaleX:s,scaleY:r}=Oe.patternLocked?this.__world:this.__nowWorld;return e&&(s<0&&(s=-s),r<0&&(r=-r)),(t===!0||t==="zoom-in"&&s>1&&r>1)&&(s=r=1),ls.scaleX=s,ls.scaleY=r,ls}getTransform(e){return this.__layout.getTransform(e||"local")}getBounds(e,t){return this.__layout.getBounds(e,t)}getLayoutBounds(e,t,s){return this.__layout.getLayoutBounds(e,t,s)}getLayoutPoints(e,t){return this.__layout.getLayoutPoints(e,t)}getWorldBounds(e,t,s){const r=t?Na(this,t):this.worldTransform,i=s?e:{};return Xr(e,r,i),i}worldToLocal(e,t,s,r){this.parent?this.parent.worldToInner(e,t,s,r):t&&Dr(t,e)}localToWorld(e,t,s,r){this.parent?this.parent.innerToWorld(e,t,s,r):t&&Dr(t,e)}worldToInner(e,t,s,r){r&&(r.innerToWorld(e,t,s),e=t||e),ka(this.scrollWorldTransform,e,t,s)}innerToWorld(e,t,s,r){Ca(this.scrollWorldTransform,e,t,s),r&&r.worldToInner(t||e,null,s)}getBoxPoint(e,t,s,r){return this.getBoxPointByInner(this.getInnerPoint(e,t,s,r),null,null,!0)}getBoxPointByInner(e,t,s,r){const i=r?e:Object.assign({},e),{x:n,y:o}=this.boxBounds;return zr(i,-n,-o),i}getInnerPoint(e,t,s,r){const i=r?e:{};return this.worldToInner(e,i,s,t),i}getInnerPointByBox(e,t,s,r){const i=r?e:Object.assign({},e),{x:n,y:o}=this.boxBounds;return zr(i,n,o),i}getInnerPointByLocal(e,t,s,r){return this.getInnerPoint(e,this.parent,s,r)}getLocalPoint(e,t,s,r){const i=r?e:{};return this.worldToLocal(e,i,s,t),i}getLocalPointByInner(e,t,s,r){return this.getWorldPoint(e,this.parent,s,r)}getPagePoint(e,t,s,r){return(this.leafer?this.leafer.zoomLayer:this).getInnerPoint(e,t,s,r)}getWorldPoint(e,t,s,r){const i=r?e:{};return this.innerToWorld(e,i,s,t),i}getWorldPointByBox(e,t,s,r){return this.getWorldPoint(this.getInnerPointByBox(e,null,null,r),t,s,!0)}getWorldPointByLocal(e,t,s,r){const i=r?e:{};return this.localToWorld(e,i,s,t),i}getWorldPointByPage(e,t,s,r){return(this.leafer?this.leafer.zoomLayer:this).getWorldPoint(e,t,s,r)}setTransform(e,t,s){Aa(this,e,t,s)}transform(e,t,s){jr(this,e,t,s)}move(e,t,s){Pa(this,e,t,s)}moveInner(e,t,s){Fr(this,e,t,!0,s)}scaleOf(e,t,s,r,i){Ta(this,us(this,e),t,s,r,i)}rotateOf(e,t,s){Sa(this,us(this,e),t,s)}skewOf(e,t,s,r,i){Ra(this,us(this,e),t,s,r,i)}transformWorld(e,t,s){Ma(this,e,t,s)}moveWorld(e,t,s){Fr(this,e,t,!1,s)}scaleOfWorld(e,t,s,r,i){La(this,e,t,s,r,i)}rotateOfWorld(e,t){Ea(this,e,t)}skewOfWorld(e,t,s,r,i){Ia(this,e,t,s,r,i)}flip(e,t){jr(this,Wa(this,e),!1,t)}scaleResize(e,t=e,s){this.scaleX*=e,this.scaleY*=t}__scaleResize(e,t){}resizeWidth(e){}resizeHeight(e){}hit(e,t){return!0}__hitWorld(e){return!0}__hit(e){return!0}__hitFill(e){return!0}__hitStroke(e,t){return!0}__hitPixel(e){return!0}__drawHitPath(e){}__updateHitCanvas(){}__render(e,t){}__drawFast(e,t){}__draw(e,t,s){}__clip(e,t){}__renderShape(e,t){}__drawShape(e,t){}__updateWorldOpacity(){}__updateChange(){}__drawPath(e){}__drawRenderPath(e){}__updatePath(){}__updateRenderPath(){}getMotionPathData(){return Be.need("path")}getMotionPoint(e){return Be.need("path")}getMotionTotal(){return 0}__updateMotionPath(){}__runAnimation(e,t){}__updateSortChildren(){}add(e,t){}remove(e,t){this.parent&&this.parent.remove(this,t)}dropTo(e,t,s){Ya(this,e,t,s)}on(e,t,s){}off(e,t,s){}on_(e,t,s,r){}off_(e){}once(e,t,s,r){}emit(e,t,s){}emitEvent(e,t){}hasEvent(e,t){return!1}static changeAttr(e,t,s){s?this.addAttr(e,t,s):ni(this.prototype,e,t)}static addAttr(e,t,s,r){s||(s=ri),s(t,r)(this.prototype,e)}__emitLifeEvent(e){this.hasEvent(e)&&this.emitEvent(new X(e,this,this.parent))}destroy(){this.destroyed||(this.parent&&this.remove(),this.children&&this.clear(),this.__emitLifeEvent(X.DESTROY),this.__.destroy(),this.__layout.destroy(),this.destroyEventer(),this.destroyed=!0)}};xs=p([zt(ua),zt(fa),zt(xa),zt(ha),zt(wa)],xs);const{setListWithFn:ds}=m,{sort:Xa}=Os,{localBoxBounds:Da,localStrokeBounds:za,localRenderBounds:Fa,maskLocalBoxBounds:ja,maskLocalStrokeBounds:Ua,maskLocalRenderBounds:Ha}=ai,Ga=new A("Branch");let Ur=class extends xs{__updateStrokeSpread(){const{children:e}=this;for(let t=0,s=e.length;t<s;t++)if(e[t].__layout.strokeSpread)return 1;return 0}__updateRenderSpread(){const{children:e}=this;for(let t=0,s=e.length;t<s;t++)if(e[t].__layout.renderSpread)return 1;return 0}__updateBoxBounds(e,t){ds(t||this.__layout.boxBounds,this.children,this.__hasMask?ja:Da)}__updateStrokeBounds(e){ds(e||this.__layout.strokeBounds,this.children,this.__hasMask?Ua:za)}__updateRenderBounds(e){ds(e||this.__layout.renderBounds,this.children,this.__hasMask?Ha:Fa)}__updateSortChildren(){let e;const{children:t}=this;if(t.length>1){for(let s=0,r=t.length;s<r;s++)t[s].__tempNumber=s,t[s].__.zIndex&&(e=!0);t.sort(Xa),this.__layout.affectChildrenSort=e}}add(e,t){if(e===this||e.destroyed)return Ga.warn("add self or destroyed");const s=w(t);if(!e.__){if(Q(e))return e.forEach(i=>{this.add(i,t),s||t++});e=Bs.get(e.tag,e)}e.parent&&e.parent.remove(e),e.parent=this,s?this.children.push(e):this.children.splice(t,0,e),e.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||0)+1);const r=e.__layout;r.boxChanged||r.boxChange(),r.matrixChanged||r.matrixChange(),e.__bubbleMap&&e.__emitLifeEvent(X.ADD),this.leafer&&(e.__bindLeafer(this.leafer),this.leafer.created&&this.__emitChildEvent(X.ADD,e)),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}addMany(...e){this.add(e)}remove(e,t){e?e.__?e.animationOut?e.__runAnimation("out",()=>this.__remove(e,t)):this.__remove(e,t):this.find(e).forEach(s=>this.remove(s,t)):w(e)&&super.remove(null,t)}removeAll(e){const{children:t}=this;t.length&&(this.children=[],this.__preRemove(),this.__.__childBranchNumber=0,t.forEach(s=>{this.__realRemoveChild(s),e&&s.destroy()}))}clear(){this.removeAll(!0)}__remove(e,t){const s=this.children.indexOf(e);s>-1&&(this.children.splice(s,1),e.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||1)-1),this.__preRemove(),this.__realRemoveChild(e),t&&e.destroy())}__preRemove(){this.__hasMask&&this.__updateMask(),this.__hasEraser&&this.__updateEraser(),this.__layout.boxChange(),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}__realRemoveChild(e){e.__emitLifeEvent(X.REMOVE),e.parent=null,this.leafer&&(e.__bindLeafer(null),this.leafer.created&&(this.__emitChildEvent(X.REMOVE,e),this.leafer.hitCanvasManager&&this.leafer.hitCanvasManager.clear()))}__emitChildEvent(e,t){const s=new X(e,t,this);this.hasEvent(e)&&!this.isLeafer&&this.emitEvent(s),this.leafer.emitEvent(s)}};Ur=p([zt(ba)],Ur);class hi{get length(){return this.list.length}constructor(t){this.reset(),t&&(Q(t)?this.addList(t):this.add(t))}has(t){return t&&!w(this.keys[t.innerId])}indexAt(t){return this.list[t]}indexOf(t){const s=this.keys[t.innerId];return w(s)?-1:s}add(t){const{list:s,keys:r}=this;w(r[t.innerId])&&(s.push(t),r[t.innerId]=s.length-1)}addAt(t,s=0){const{keys:r}=this;if(w(r[t.innerId])){const{list:i}=this;for(let n=s,o=i.length;n<o;n++)r[i[n].innerId]++;s===0?i.unshift(t):(s>i.length&&(s=i.length),i.splice(s,0,t)),r[t.innerId]=s}}addList(t){for(let s=0;s<t.length;s++)this.add(t[s])}remove(t){const{list:s}=this;let r;for(let i=0,n=s.length;i<n;i++)w(r)?s[i].innerId===t.innerId&&(r=i,delete this.keys[t.innerId]):this.keys[s[i].innerId]=i-1;w(r)||s.splice(r,1)}sort(t){const{list:s}=this;t?s.sort((r,i)=>i.__level-r.__level):s.sort((r,i)=>r.__level-i.__level)}forEach(t){this.list.forEach(t)}clone(){const t=new hi;return t.list=[...this.list],t.keys=Object.assign({},this.keys),t}update(){this.keys={};const{list:t,keys:s}=this;for(let r=0,i=t.length;r<i;r++)s[t[r].innerId]=r}reset(){this.list=[],this.keys={}}destroy(){this.reset()}}class Lh{get length(){return this._length}constructor(t){this._length=0,this.reset(),t&&(Q(t)?this.addList(t):this.add(t))}has(t){return!w(this.keys[t.innerId])}without(t){return w(this.keys[t.innerId])}sort(t){const{levels:s}=this;t?s.sort((r,i)=>i-r):s.sort((r,i)=>r-i)}addList(t){t.forEach(s=>{this.add(s)})}add(t){const{keys:s,levelMap:r}=this;s[t.innerId]||(s[t.innerId]=1,r[t.__level]?r[t.__level].push(t):(r[t.__level]=[t],this.levels.push(t.__level)),this._length++)}forEach(t){let s;this.levels.forEach(r=>{s=this.levelMap[r];for(let i=0,n=s.length;i<n;i++)t(s[i])})}reset(){this.levelMap={},this.keys={},this.levels=[],this._length=0}destroy(){this.levelMap=null}}export{uh as $,Y as A,ct as B,qs as C,ki as D,_t as E,xs as F,st as G,N as H,Kt as I,hh as J,dh as K,Pt as L,Za as M,th as N,Oh as O,Sr as P,ah as Q,Th as R,Ps as S,Qa as T,Be as U,Bs as V,Ce as W,qa as X,S as Y,lh as Z,ks as _,hi as a,Oe as a0,A as a1,m as a2,j as a3,Q as a4,nh as a5,zt as a6,Ph as a7,Ur as a8,Ro as a9,zn as aa,ci as ab,w as ac,J as ad,ih as ae,os as af,Pe as ag,Ja as ah,pt as ai,ve as aj,Ut as ak,Sh as al,Va as am,Ka as an,rh as ao,ai as ap,Ns as aq,Lh as ar,Os as as,X as at,St as au,b as av,fi as aw,wi as ax,Se as ay,xe as az,wt as b,xh as c,yh as d,ch as e,wh as f,bh as g,fh as h,eh as i,Ft as j,sh as k,gh as l,vh as m,ph as n,te as o,Cs as p,oh as q,_h as r,Re as s,ri as t,mh as u,$a as v,Ch as w,kh as x,Bh as y,Rh as z};
