import{l as E,c as S}from"./element-plus-gomRs06A.js";import{s as L,r as M,l as y,B as D,d as P,e as Z,w as T,c as z,a as h,V as b,Q as F,K as G,aw as R,ax as V,o as O,X as C,W as x,u as k}from"./@vue-1pEateLc.js";import{l as n}from"./leaflet-dgfGk-q1.js";import"./leaflet.chinatmsproviders-MeioCgZa.js";import{p as Q,q as U}from"./@element-plus-GFHZwatb.js";import{_ as W}from"./plugin-vueexport-helper-x3n3nnut.js";import"./lodash-es-88S84ShG.js";import"./@vueuse-sS3gTgD0.js";import"./@sxzz--N-3kK7X.js";import"./@ctrl-ZggoHSuR.js";import"./dayjs-0oS7_Iqn.js";import"./@turf-VZU31W4K.js";import"./async-validator-BHjhHa7C.js";import"./memoize-one-JaOscZgY.js";import"./normalize-wheel-es-1urBKM79.js";import"./@floating-ui-_1sru3kO.js";const q=""+new URL("../png/image-BQhIfE8b.png",import.meta.url).href,A=p=>{const l=L(null),r=M([]),d=n.tileLayer.chinaProvider("GaoDe.Normal.Map",{maxZoom:18,minZoom:4}),v=n.layerGroup([d]),_=[],w=()=>{const t=n.latLng(-90,-180),o=n.latLng(90,180),a=n.latLngBounds(t,o),s=n.canvas();l.value=new n.Map(p,{maxZoom:18,minZoom:4,zoom:14,attributionControl:!1,layers:[v],maxBounds:a,renderer:s,crs:n.CRS.EPSG3857,zoomControl:!1,doubleClickZoom:!1})},g=(t,o)=>{var a;if(t!=null&&t.length){const s=[];t.forEach(e=>{s.push({lng:e.pointData[0].lon,lat:e.pointData[0].lat});const f=n.circleMarker({lat:e.pointData[0].lat,lng:e.pointData[0].lon},{stroke:!0,color:"#fff",fillColor:"red",fill:!0,fillOpacity:1,radius:10,data:{name:e.name,id:e.businessId,checked:o==null?void 0:o.includes(e.businessId)}}).addTo(l.value);_.push(f),u(f,e.name,o==null?void 0:o.includes(e.businessId)),f.on("click",i)});const c=n.latLngBounds(s);(a=l.value)==null||a.fitBounds(c,{padding:[10,10]})}},i=t=>{const o=t.target,a=o.options.data,s=!a.checked;if(s&&r.value.length+1>3){E.warning("最多只能选择3个井");return}o.setStyle({data:{...a,checked:s}}),s?u(o,a.name,!0):u(o,a.name,!1)},u=(t,o,a=!1)=>{const s={permanent:!0,direction:"top",className:"",offset:[0,-5],opacity:.8};if(a)s.className="tooltip",t.bindTooltip(o,s),r.value.push(t.options.data.id);else{t.bindTooltip(o,s);const c=r.value.indexOf(t.options.data.id);c>-1&&r.value.splice(c,1)}},m=()=>{l.value&&(_.forEach(t=>{t.off("click",i)}),l.value.remove())};return y(()=>{w()}),D(()=>{m()}),{map:l,checked:r,drawPoint:g}},B=p=>(R("data-v-1996750e"),p=p(),V(),p),I=B(()=>h("div",{class:"map"},[h("div",{id:"map",class:"h-full w-full"})],-1)),K=B(()=>h("div",{class:"action"},[h("span",null,"北"),h("img",{src:q,alt:""})],-1)),X={class:"trigger"},$={name:""},j=P({...$,props:{data:{type:Array,default:()=>[]}},emits:["checked"],setup(p,{emit:l}){const r=p,d=Z({isCollpased:!1}),{checked:v,drawPoint:_}=A("map"),w=l;return T(()=>v.value,g=>{const i=[];g.forEach(u=>{let m=0,t=0;const o=r.data.find(a=>a.businessId===u);if(o){const a=o.info.map((s,c)=>{if(c===0)return{...s,width:0,height:0};{const e=s.tvd-o.info[c-1].tvd,f=s.md-o.info[c-1].md;m+=f;const N=Number((f*f-e*e).toFixed(2));return t+=N,{...s,width:t,height:m}}});i.push({...o,info:a,length:Number(t.toFixed(2)),distance:Number(m.toFixed(2))})}}),w("checked",i)},{deep:!0}),y(()=>{_(r.data,["1676779130877161474"])}),(g,i)=>{const u=S;return O(),z("div",{class:G(["leaflet-container",{collpased:d.isCollpased}])},[I,K,h("div",X,[b(u,{class:"trigger-icon",onClick:i[0]||(i[0]=m=>d.isCollpased=!d.isCollpased)},{default:F(()=>[C(b(k(Q),null,null,512),[[x,!d.isCollpased]]),C(b(k(U),null,null,512),[[x,d.isCollpased]])]),_:1})])],2)}}}),mo=W(j,[["__scopeId","data-v-1996750e"]]);export{mo as default};
