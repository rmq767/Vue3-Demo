import{b as k,e as E,i as M,n as W,Y as _,ac as H,d as D,aw as S,Z as I,o as j,c as G,a as A,u as T}from"./@vue-TgkIvK3c.js";import{p as o}from"./paper-odurGvJj.js";import{D as Y}from"./demo1-ecsBbM2c.js";import{_ as X}from"./plugin-vueexport-helper-x3n3nnut.js";import"./acorn-bQvPYi_r.js";const O=d=>{d={...{zoom:!0,canvasHandle:"drag",itemHandle:"none",tooltips:"我是提示"},...d};const i=k(new o.PaperScope),f=k(),y=k(1),h=k(),p=k(),w=k("default"),b={x:0,y:0},x=new WeakMap;E(()=>p.value,(n,r)=>{r&&r[0].remove()});const P=n=>{d.zoom&&(n.preventDefault(),i.value.view.zoom=i.value.view.zoom*(1+n.wheelDelta/1e3),y.value=i.value.view.zoom)},L=()=>{i.value.view.onMouseDown=n=>{var e,l;const r=n.target,s=H(i.value.view);if(d.canvasHandle==="drag"){const a=c=>{const v=c.x-b.x,t=c.y-b.y;i.value.view.translate({x:v/y.value,y:t/y.value}),b.x=c.x,b.y=c.y},u=()=>{var c,v;(c=f.value)==null||c.removeEventListener("mousemove",a),(v=f.value)==null||v.removeEventListener("mouseup",u)};r===s&&(b.x=n.event.pageX,b.y=n.event.pageY,y.value=i.value.view.zoom,(e=f.value)==null||e.addEventListener("mousemove",a),(l=f.value)==null||l.addEventListener("mouseup",u))}d.canvasHandle==="select"&&(r===s&&(h.value=new o.Path.Rectangle(n.point,new o.Size(1,1)),h.value.strokeWidth=1,h.value.strokeColor=new o.Color(0,0,0,.5),h.value.style.dashArray=[4,4]),p.value&&r===s&&p.value[0].remove())},i.value.view.onMouseDrag=n=>{h.value&&(h.value.bounds.width+=n.delta.x,h.value.bounds.height+=n.delta.y)},i.value.view.onMouseUp=n=>{var r;if(h.value){const s=i.value.project.getItems({match:l=>{const{topLeft:a,bottomRight:u}=l.bounds;if(a.x>h.value.bounds.topLeft.x&&a.y>h.value.bounds.topLeft.y&&u.x<h.value.bounds.bottomRight.x&&u.y<h.value.bounds.bottomRight.y)return l}}),e=new o.Group([...s]);p.value=g(e),(r=i.value.project)==null||r.activeLayer.addChild(p.value[1]),h.value.remove(),h.value=void 0,b.x=0,b.y=0}}},g=n=>{var v;const r=new o.Path.Rectangle({center:n.bounds.center,size:n.bounds.size,strokeColor:new o.Color("blue"),strokeWidth:1}),s=new o.Path.Rectangle({center:n.bounds.topLeft,size:[10,10],fillColor:new o.Color("#fff"),strokeColor:new o.Color("blue"),strokeWidth:1,name:"topLeftRect"}),e=new o.Path.Rectangle({center:n.bounds.topRight,size:[10,10],fillColor:new o.Color("#fff"),strokeColor:new o.Color("blue"),strokeWidth:1,name:"topRightRect"}),l=new o.Path.Rectangle({center:n.bounds.bottomLeft,size:[10,10],fillColor:new o.Color("#fff"),strokeColor:new o.Color("blue"),strokeWidth:1,name:"bottomLeftRect"}),a=new o.Path.Rectangle({center:n.bounds.bottomRight,size:[10,10],fillColor:new o.Color("#fff"),strokeColor:new o.Color("blue"),strokeWidth:1,name:"bottomRightRect"}),u=new o.Group([r,s,e,l,a]),c=new o.Group([n,u]);return(v=d.itemHandle)!=null&&v.includes("drag")&&(c.onMouseDrag=t=>{t.stopPropagation(),c.position.set(n.position.x+t.delta.x,n.position.y+t.delta.y)}),s.onMouseDrag=t=>{t.stopPropagation(),!(n.bounds.size.height-t.delta.y<=20||n.bounds.size.width-t.delta.x<=20)&&(n.bounds.center.y+=t.delta.y,n.bounds.center.x+=t.delta.x,n.bounds.size.height-=t.delta.y,n.bounds.size.width-=t.delta.x,r.bounds.center.y+=t.delta.y,r.bounds.center.x+=t.delta.x,r.bounds.size.height-=t.delta.y,r.bounds.size.width-=t.delta.x,s.bounds.x+=t.delta.x,s.bounds.y+=t.delta.y,e.bounds.y+=t.delta.y,l.bounds.x+=t.delta.x)},e.onMouseDrag=t=>{t.stopPropagation(),!(n.bounds.size.height-t.delta.y<=20||n.bounds.size.width+t.delta.x<=20)&&(n.bounds.center.y+=t.delta.y,n.bounds.size.height-=t.delta.y,n.bounds.size.width+=t.delta.x,r.bounds.center.y+=t.delta.y,r.bounds.size.height-=t.delta.y,r.bounds.size.width+=t.delta.x,e.bounds.x+=t.delta.x,e.bounds.y+=t.delta.y,s.bounds.y+=t.delta.y,a.bounds.x+=t.delta.x)},l.onMouseDrag=t=>{t.stopPropagation(),!(n.bounds.size.height+t.delta.y<=20||n.bounds.size.width-t.delta.x<=20)&&(n.bounds.center.x+=t.delta.x,n.bounds.size.height+=t.delta.y,n.bounds.size.width-=t.delta.x,r.bounds.center.x+=t.delta.x,r.bounds.size.height+=t.delta.y,r.bounds.size.width-=t.delta.x,l.bounds.x+=t.delta.x,l.bounds.y+=t.delta.y,s.bounds.x+=t.delta.x,a.bounds.y+=t.delta.y)},a.onMouseDrag=t=>{t.stopPropagation(),!(n.bounds.size.height+t.delta.y<=20||n.bounds.size.width+t.delta.x<=20)&&(n.bounds.size.height+=t.delta.y,n.bounds.size.width+=t.delta.x,r.bounds.size.height+=t.delta.y,r.bounds.size.width+=t.delta.x,a.bounds.x+=t.delta.x,a.bounds.y+=t.delta.y,e.bounds.x+=t.delta.x,l.bounds.y+=t.delta.y)},[s,e,l,a].forEach(t=>{t.onMouseLeave=C=>{C.stopPropagation(),w.value="default"},t.onMouseEnter=C=>{switch(C.stopPropagation(),C.target.name){case"topLeftRect":w.value="nw-resize";break;case"topRightRect":w.value="ne-resize";break;case"bottomLeftRect":w.value="sw-resize";break;case"bottomRightRect":w.value="se-resize";break}}}),[u,c]},R=()=>{const n=i.value.project.activeLayer.children;n==null||n.forEach(r=>{r.onMouseDown=s=>{var e;(e=d.itemHandle)!=null&&e.includes("select")?(x.has(s.target)?(p.value=x.get(s.target),p.value[0].remove(),x.delete(s.target),p.value=g(s.target)):p.value?p.value[1].getItems({match:a=>{if(a===s.target)return a}}).length||(p.value=g(s.target),x.set(s.target,p.value)):p.value=g(s.target),i.value.project.activeLayer.addChild(p.value[1])):(d.itemHandle==="drag"||d.itemHandle&&d.itemHandle[0]==="drag")&&i.value.project.activeLayer.addChild(s.target)},r.onMouseDrag=s=>{(d.itemHandle==="drag"||d.itemHandle&&d.itemHandle[0]==="drag")&&r.position.set(r.position.x+s.delta.x,r.position.y+s.delta.y);let e=document.querySelector(".tootips");e?(e.style.display="block",e.style.left=s.event.offsetX+10+"px",e.style.top=s.event.offsetY+10+"px"):(e=document.createElement("div"),document.body.appendChild(e),e.innerHTML=typeof d.tooltips=="string"?d.tooltips:d.tooltips(),e.className="tootips",e.style.position="absolute",e.style.left=s.event.offsetX+10+"px",e.style.top=s.event.offsetY+10+"px",e.style.color="#999")},r.onMouseEnter=s=>{w.value="pointer"},r.onMouseLeave=()=>{w.value="defatul";let s=document.querySelector(".tootips");s.style.display="none"},r.onMouseMove=s=>{let e=document.querySelector(".tootips");e?(e.style.display="block",e.style.left=s.event.offsetX+10+"px",e.style.top=s.event.offsetY+10+"px"):(e=document.createElement("div"),document.body.appendChild(e),e.innerHTML=typeof d.tooltips=="string"?d.tooltips:d.tooltips(),e.className="tootips",e.style.position="absolute",e.style.left=s.event.offsetX+10+"px",e.style.top=s.event.offsetY+10+"px",e.style.color="#999")}})};return M(()=>{var n;i.value.setup(f.value),(n=f.value)==null||n.addEventListener("wheel",P),W(()=>{L(),R()})}),_(()=>{var n;i.value.project.clear(),(n=f.value)==null||n.removeEventListener("wheel",P)}),{paperInstance:i,canvasEl:f,zoom:y,cursor:w,selectionGroup:p,addSelect:g,registerMouseEvent:R}},F={class:"container"},q={name:"Paper"},B=D({...q,setup(d){S(e=>({b3d8b872:T(y)}));let z="right";const i=I({zoom:!0,canvasHandle:"select",itemHandle:["select","drag"],tooltips:()=>"123"}),{canvasEl:f,cursor:y,registerMouseEvent:h}=O(i),p=()=>{const e=new o.Path.Circle({center:[200,100],radius:50});e.strokeColor=new o.Color("black"),e.fillColor=new o.Color("white"),e.onFrame=()=>{const l=document.body.clientWidth;z==="right"?e.bounds.right>=l&&(z="left"):e.bounds.left<=0&&(z="right"),z==="right"?e.bounds.x+=5:e.bounds.x-=5}},w=()=>{const e=new o.Path.Circle({center:[200,100],radius:50,fillColor:new o.Color("red"),strokeColor:new o.Color("black"),cursor:"pointer"});e.strokeWidth=2;const l="M 50 100 L 100 0 L 0 0 Z",a=new o.Path(l);a.strokeColor=new o.Color("black"),a.fillColor=new o.Color("green"),a.strokeWidth=2,a.strokeWidth=2,a.position.set(400,100)},b=()=>{const e=new o.Point(500,100),l=new o.Path;l.add(e);const a=e.clone();a.set(600,100),l.add(a),l.strokeColor=new o.Color("black"),l.strokeWidth=4},x=()=>{new o.Path.Rectangle({center:[200,400],size:[50,100],radius:[5,5],fillColor:"orange",strokeColor:"black",strokeWidth:4,rotation:45});const e=new o.Point(200,20),l=new o.Size(200,200),a=new o.Rectangle(e,l),u=new o.Size(30,30),c=new o.Path.Rectangle(a,u);c.fillColor=new o.Color("blue"),c.position.set({x:300,y:300})},P=()=>{const e=new o.Raster(Y),l=new o.Rectangle(e.bounds.topLeft,e.bounds.size),a=new o.Path.Rectangle(l);a.strokeColor=new o.Color("transparent"),a.strokeWidth=4,e.position.set(700,600),e.scale(.2)},L=()=>{new o.PointText({position:[1600,50],fillColor:"black",justification:"center",fontSize:20,content:"下载",locked:!1,name:"download",style:{cursor:"pointer"}})},g=()=>{const e=new o.Group,l=new o.PointText({position:[0,-60],content:"圆",fillColor:"black",justification:"center",fontSize:20}),a=new o.Path.Circle({center:[0,0],radius:50,fillColor:"red"});e.addChildren([l,a]),e.position.set(1200,800)},R=()=>{const e=new o.Group,l=new o.Path.Circle({center:[800,200],radius:50,fillColor:new o.Color("green")});var a=s(800,200,50,Math.PI/18*19),u=s(800,200,50,Math.PI/18*1),c=new o.Point(160,60),v=new o.Point(-160,20),t=new o.Segment(a,void 0,v),C=new o.Segment(u,c,void 0);const m=new o.Path([t,C]);m.strokeColor=new o.Color("black"),m.strokeWidth=8,m.locked=!0,m.selected=!1,m.style.strokeCap="round",e.addChildren([l,m])},n=()=>{const e=new o.Path.Line({from:[1200,200],to:[1200,600],strokeColor:new o.Color("red"),strokeWidth:8});e.style.dashArray=[10,10],e.onFrame=()=>{e.style.dashOffset-=1,e.style.dashOffset<=0&&(e.style.dashOffset=100)}},r=()=>{const e=new o.Group,l=new o.Path.Arc({from:[0,50],through:[50,0],to:[50,100],strokeColor:"black",fillColor:"red",strokeWidth:4}),a="M 50 50 L 50 101 L -1 50 Z",u=new o.Path(a);u.fillColor=new o.Color("white"),u.strokeWidth=0,e.addChildren([l,u])},s=(e,l,a,u)=>{var c=e+a*Math.cos(u),v=l+a*Math.sin(u);return new o.Point(c,v)};return M(()=>{w(),b(),x(),P(),L(),g(),n(),p(),r(),setTimeout(()=>{R(),h()},3e3)}),(e,l)=>(j(),G("div",F,[A("canvas",{id:"myCanvas",ref_key:"canvasEl",ref:f},null,512)]))}}),K=X(B,[["__scopeId","data-v-1d85735d"]]);export{K as default};
